/***************************************************************************
                               layoutwriter.cpp
                             ------------------
    begin                : Thu Oct 25 2018
    copyright            : (C) 2018 by Thomas Lepoix
    email                : thomas.lepoix@protonmail.ch
 ***************************************************************************/

/***************************************************************************
 *                                                                         *
 *   This program is free software; you can redistribute it and/or modify  *
 *   it under the terms of the GNU General Public License as published by  *
 *   the Free Software Foundation; either version 2 of the License, or     *
 *   (at your option) any later version.                                   *
 *                                                                         *
 ***************************************************************************/

#include <algorithm>
#include <iostream>
#include <iterator>
#include <regex>
#include <utility>

#include "logger.hpp"
#include "oemsmesh.hpp"
#include "microstrip/element.hpp"
#include "microstrip/subst.hpp"
#include "layoutwriter.hpp"
using namespace std;

//******************************************************************************
LayoutWriter::LayoutWriter(Data& _data) :
	data(_data)
	{}

//******************************************************************************
int LayoutWriter::run(vector<string>* out_names) {

//variables
	static regex const r_sch("\\.sch$");
	static regex const r_basename("^.*?([^\\/]*)\\.sch$"); // g1 basename
	static regex const r_out("(^.*?)\\/?$");
	static regex const r_empty("^$");
	string name=regex_replace(regex_replace(data.n_sch, r_basename, "$1"), r_sch, "");
	string n_out=regex_replace(data.out_dir, r_empty, "./");
	n_out=regex_replace(n_out, r_out, "$1/") + regex_replace(data.n_sch, r_basename, "$1");

//check
	int ret=0;
	if(data.out_format==".m") ret=check_m();
	if(ret) return(ret);

	cout << endl;
	cout << "Input schematic : " << data.n_sch << endl;

	if(data.export_each_block) {
		unsigned int i=-1; // not a mistake
		for(shared_ptr<Block> it : data.all_blocks) {
			string out=n_out+"-b"+to_string(++i)+data.out_format;

			Block block;
			block.boundary=it->boundary;
			block.boundary[XMIN]-=it->subst_local->getMargin();
			block.boundary[XMAX]+=it->subst_local->getMargin();
			block.boundary[YMIN]-=it->subst_local->getMargin();
			block.boundary[YMAX]+=it->subst_local->getMargin();

			block.elements=it->elements;
			block.elements.push_back(it->subst_local);
			for(shared_ptr<Element> element : data.tab_all) {
				if(element->getType()==".SP")
					block.elements.push_back(element);
				}

			int ret=write(block, -block.boundary[XMIN], -block.boundary[YMIN], out, name+"-b"+to_string(i), out_names);
			if(ret) return(ret);
			}
	} else if(data.export_each_subst) {
		unsigned int i=-1; // not a mistake
		shared_ptr<Block> prev=nullptr;
		string out;
		Block block;
		for(shared_ptr<Block> it : data.all_blocks) {
			if(prev==nullptr || it->subst!=prev->subst) {
				if(prev!=nullptr) {
					out=n_out+"-s"+to_string(++i)+data.out_format;
					int ret=write(block, -block.boundary[XMIN], -block.boundary[YMIN], out, name+"-s"+to_string(i), out_names);
					if(ret) return(ret);
					}

				Subst* subst=dynamic_cast<Subst*>(it->subst.get());
				block.boundary=subst->extrem_pos;
				block.boundary[XMIN]-=subst->getMargin();
				block.boundary[XMAX]+=subst->getMargin();
				block.boundary[YMIN]-=subst->getMargin();
				block.boundary[YMAX]+=subst->getMargin();

				block.elements.clear();
				block.elements=it->elements;
				block.elements.push_back(it->subst);
				for(shared_ptr<Element> element : data.tab_all) {
					if(element->getType()==".SP")
						block.elements.push_back(element);
					}
			} else {
				block.elements.insert(block.elements.end(), it->elements.begin(), it->elements.end());
				}
			prev=it;
			}
		out=n_out+"-s"+to_string(++i)+data.out_format;
		int ret=write(block, -block.boundary[XMIN], -block.boundary[YMIN], out, name+"-s"+to_string(i), out_names);
		if(ret) return(ret);
	} else {
		Block block;
		block.boundary=data.extrem_pos;
		block.elements=data.tab_all;

		n_out+=data.out_format;
		return(write(block, 0, 0, n_out, name, out_names));
		}

	return(0);
	}

//******************************************************************************
int LayoutWriter::write(Block& block, long double const offset_x, long double const offset_y, string const& n_out, string const& name, vector<string>* out_names) {
	cout << "Output layout : " << n_out << endl;
	ofstream f_out(n_out.c_str());
	if(f_out.fail()) {
		log_err << "ERROR : Unable to write " << n_out << "\n";
		return(1);
		}

	if(data.out_format==".kicad_pcb") write_kicad_pcb(block, f_out, offset_x, offset_y, name);
	else if(data.out_format==".kicad_mod") write_kicad_mod(block, f_out, offset_x, offset_y, name);
	else if(data.out_format==".lht") write_lht(block, f_out, offset_x, offset_y, name);
	else if(data.out_format==".m") write_m(block, f_out, offset_x, offset_y, name);
	if(out_names) out_names->push_back(n_out); //success message to stdout in GUI mode

	if(f_out.fail()) {
		log_err << "ERROR : Error occured while writing " << n_out << "\n";
		return(1);
		}

	return(0);
	}

//******************************************************************************
void LayoutWriter::write_kicad_pcb(Block& block, ofstream& f_out, long double const offset_x, long double const offset_y, string const& name) {
	string type;

	f_out << "# Generated by Qucs-RFlayout from : " << name << ".sch\n"
	         "\n"
	         "(kicad_pcb (version 0) (host pcbnew 0.0.0)\n"
	         "\n"
	         "  (general\n"
	         "    (thickness 1.6)\n"
	         "    (drawings 0)\n"
	         "    (tracks 0)\n"
	         "    (zones 0)\n"
	         "    (modules 0)\n"
	         "    (nets 1)\n"
	         "  )\n"
	         "\n"
	         "  (page A4)\n"
	         "  (layers\n"
	         "    (0 F.Cu signal)\n"
	         "    (31 B.Cu signal)\n"
	         "    (32 B.Adhes user)\n"
	         "    (33 F.Adhes user)\n"
	         "    (34 B.Paste user)\n"
	         "    (35 F.Paste user)\n"
	         "    (36 B.SilkS user)\n"
	         "    (37 F.SilkS user)\n"
	         "    (38 B.Mask user)\n"
	         "    (39 F.Mask user)\n"
	         "    (40 Dwgs.User user)\n"
	         "    (41 Cmts.User user)\n"
	         "    (42 Eco1.User user)\n"
	         "    (43 Eco2.User user)\n"
	         "    (44 Edge.Cuts user)\n"
	         "    (45 Margin user)\n"
	         "    (46 B.CrtYd user)\n"
	         "    (47 F.CrtYd user)\n"
	         "    (48 B.Fab user)\n"
	         "    (49 F.Fab user)\n"
	         "  )\n"
	         "\n"
	         "  (setup\n"
	         "    (last_trace_width 0.25)\n"
	         "    (trace_clearance 0.2)\n"
	         "    (zone_clearance 0.508)\n"
	         "    (zone_45_only no)\n"
	         "    (trace_min 0.2)\n"
	         "    (segment_width 0.2)\n"
	         "    (edge_width 0.15)\n"
	         "    (via_size 0.8)\n"
	         "    (via_drill 0.4)\n"
	         "    (via_min_size 0.4)\n"
	         "    (via_min_drill 0.3)\n"
	         "    (uvia_size 0.3)\n"
	         "    (uvia_drill 0.1)\n"
	         "    (uvias_allowed no)\n"
	         "    (uvia_min_size 0.2)\n"
	         "    (uvia_min_drill 0.1)\n"
	         "    (pcb_text_width 0.3)\n"
	         "    (pcb_text_size 1.5 1.5)\n"
	         "    (mod_edge_width 0.15)\n"
	         "    (mod_text_size 1 1)\n"
	         "    (mod_text_width 0.15)\n"
	         "    (pad_size 1.524 1.524)\n"
	         "    (pad_drill 0.762)\n"
	         "    (pad_to_mask_clearance 0.051)\n"
	         "    (solder_mask_min_width 0.25)\n"
	         "    (aux_axis_origin 0 0)\n"
	         "    (visible_elements FFFFFF7F)\n"
	         "    (pcbplotparams\n"
	         "      (layerselection 0x010fc_ffffffff)\n"
	         "      (usegerberextensions false)\n"
	         "      (usegerberattributes false)\n"
	         "      (usegerberadvancedattributes false)\n"
	         "      (creategerberjobfile false)\n"
	         "      (excludeedgelayer true)\n"
	         "      (linewidth 0.150000)\n"
	         "      (plotframeref false)\n"
	         "      (viasonmask false)\n"
	         "      (mode 1)\n"
	         "      (useauxorigin false)\n"
	         "      (hpglpennumber 1)\n"
	         "      (hpglpenspeed 20)\n"
	         "      (hpglpendiameter 15.000000)\n"
	         "      (psnegative false)\n"
	         "      (psa4output false)\n"
	         "      (plotreference true)\n"
	         "      (plotvalue true)\n"
	         "      (plotinvisibletext false)\n"
	         "      (padsonsilk false)\n"
	         "      (subtractmaskfromsilk false)\n"
	         "      (outputformat 1)\n"
	         "      (mirror false)\n"
	         "      (drillshape 1)\n"
	         "      (scaleselection 1)\n"
	         "      (outputdirectory \"\"))\n"
	         "  )\n"
	         "\n"
	         "  (net 0 \"\")\n"
	         "\n"
	         "  (net_class Default \"This is the default net class.\"\n"
	         "    (clearance 0.2)\n"
	         "    (trace_width 0.25)\n"
	         "    (via_dia 0.8)\n"
	         "    (via_drill 0.4)\n"
	         "    (uvia_dia 0.3)\n"
	         "    (uvia_drill 0.1)\n"
	         "  )\n\n";

	for(shared_ptr<Element> it : block.elements) {
		if(!it->getActive())
			continue;
		type=it->getType();
		if(type=="Pac" || type=="SUBST" || type=="MGAP" || type=="MOPEN" || type=="MSTEP") {
			//nothing to do
		} else if(type=="MCORN"
				||type=="MCROSS"
				||type=="MCOUPLED"
				||type=="MMBEND"
				||type=="MLIN"
				||type=="MRSTUB"
				||type=="MTEE") {///////////////////////////////////////////////
			f_out << "  (module " << it->getType() << " (layer F.Cu) (tedit 0) (tstamp 0)\n"
			         "    (at " << it->getX()+offset_x << " " << it->getY()+offset_y << " " << it->getR() << ")\n"
			         "    (fp_text reference " << it->getLabel() << " (at 0 0.5) (layer F.SilkS)\n"
			         "      (effects (font (size 0.25 0.25) (thickness 0.05)))\n"
			         "    )\n"
			         "    (fp_text value " << it->getDescriptor() << " (at 0 -0.5) (layer F.Fab)\n"
			         "      (effects (font (size 0.25 0.25) (thickness 0.05)))\n"
			         "    )\n";
			if(type=="MCOUPLED") {//////////////////////////////////////////////
				f_out << "    (fp_poly (pts\n";
				for(int i=0;i<it->getNpoint()/2;i++) {
					f_out << "      (xy " << it->getP(i, X, NOR, REL)
					      << " "          << it->getP(i, Y, NOR, REL) << ")\n";
					}
				f_out << "      ) (layer F.Cu) (width 0)\n    )\n"
				         "    (fp_poly (pts\n";
				for(int i=it->getNpoint()/2;i<it->getNpoint();i++) {
					f_out << "      (xy " << it->getP(i, X, NOR, REL)
					      << " "          << it->getP(i, Y, NOR, REL) << ")\n";
					}
				f_out << "      ) (layer F.Cu) (width 0)\n    )\n  )\n\n";
			} else {////////////////////////////////////////////////////////////
				f_out << "    (fp_poly (pts\n";
				for(int i=0;i<it->getNpoint();i++) {
					f_out << "      (xy " << it->getP(i, X, NOR, REL)
					      << " "          << it->getP(i, Y, NOR, REL) << ")\n";
					}
				f_out << "      ) (layer F.Cu) (width 0)\n    )\n  )\n\n";
				}
		} else if(type=="MVIA") {///////////////////////////////////////////////
			f_out << "  (via (at " << it->getX()+offset_x << " " << it->getY()+offset_y
			      << ") (size " << it->getD() << ") (drill " << it->getD() << ") (layers F.Cu B.Cu))\n\n";
			}
		}

	f_out << ")\n";
	}

//******************************************************************************
void LayoutWriter::write_kicad_mod(Block& block, ofstream& f_out, long double const offset_x, long double const offset_y, string const& name) {
	string type;
	string label;
	smatch match;
	regex r_pac("^P([0-9]*)$"); //g1 number // TODO getN() ?

	f_out << "# Generated by Qucs-RFlayout from : " << name << ".sch\n"
	         "\n"
	         "(module " << name << " (layer F.Cu) (tedit 5BD7B6BE)\n"
	         "  (fp_text reference REF** (at 0 0.5) (layer F.SilkS)\n"
	         "    (effects (font (size 1 1) (thickness 0.15)))\n"
	         "  )\n"
	         "  (fp_text value " << name << " (at 0 -0.5) (layer F.Fab)\n"
	         "    (effects (font (size 1 1) (thickness 0.15)))\n"
	         "  )\n";

	for(shared_ptr<Element> it : block.elements) {
		if(!it->getActive())
			continue;
		type=it->getType();
		if(type=="SUBST" || type=="MGAP" || type=="MOPEN" || type=="MSTEP") {
			//nothing to do
		} else if(type=="Pac") {////////////////////////////////////////////////
			label=it->getLabel();
			regex_search(label, match, r_pac);
			f_out << "    (pad \"" << match.str(1) << "\" smd rect (at " << it->getX()+offset_x << " " << it->getY()+offset_y
			      << " " << it->getR() << ") (size 0.01 0.01) (layers F.Cu))\n";
		} else if(type=="MCORN"
				||type=="MCROSS"
				||type=="MMBEND"
				||type=="MLIN"
				||type=="MRSTUB"
				||type=="MTEE") {///////////////////////////////////////////////
			f_out << "    (fp_poly (pts\n";
			for(int i=0;i<it->getNpoint();i++) {
				f_out << "      (xy " << it->getP(i, X, R, ABS)+offset_x
				      << " "          << it->getP(i, Y, R, ABS)+offset_y << ")\n";
				}
			f_out << "      ) (layer F.Cu) (width 0)\n    )\n";
		} else if(type=="MCOUPLED") {///////////////////////////////////////////
			f_out << "    (fp_poly (pts\n";
			for(int i=0;i<it->getNpoint()/2;i++) {
				f_out << "      (xy " << it->getP(i, X, R, ABS)+offset_x
				      << " "          << it->getP(i, Y, R, ABS)+offset_y << ")\n";
				}
			f_out << "      ) (layer F.Cu) (width 0)\n    )\n"
			         "    (fp_poly (pts\n";
			for(int i=it->getNpoint()/2;i<it->getNpoint();i++) {
				f_out << "      (xy " << it->getP(i, X, R, ABS)+offset_x
				      << " "          << it->getP(i, Y, R, ABS)+offset_y << ")\n";
				}
			f_out << "      ) (layer F.Cu) (width 0)\n    )\n";
		} else if(type=="MVIA") {///////////////////////////////////////////////
			f_out << "  (pad \"\" thru_hole circle (at " << it->getX()+offset_x << " " << it->getY()+offset_y
			      << ") (size " << it->getD() << " " << it->getD() << ") (drill " << it->getD() << ") (layers *.Cu))\n";
			}
		}

	f_out << ")\n";
	}

//******************************************************************************
void LayoutWriter::write_lht(Block& block, ofstream& f_out, long double const offset_x, long double const offset_y, string const& name) {
	string type;
	unsigned int n=0;

	f_out << "# Generated by Qucs-RFlayout from : " << name << ".sch\n"
	         "\n"
	         "ha:pcb-rnd-board-v4 {\n"
	         "\n"
	         " ha:attributes {\n"
	         "   {PCB::grid::unit}=mm\n"
	         " }\n"
	         "\n"
	         " li:styles {\n"
	         "   ha:Signal {\n"
	         "    diameter = 2.0mm\n"
	         "    thickness = 10.0mil\n"
	         "    hole = 31.5mil\n"
	         "    clearance = 20.0mil\n"
	         "   }\n"
	         "   ha:Power {\n"
	         "    diameter = 2.2mm\n"
	         "    thickness = 20.0mil\n"
	         "    hole = 1.0mm\n"
	         "    clearance = 20.0mil\n"
	         "   }\n"
	         "   ha:Fat {\n"
	         "    diameter = 137.8mil\n"
	         "    thickness = 80.0mil\n"
	         "    hole = 47.24mil\n"
	         "    clearance = 25.0mil\n"
	         "   }\n"
	         "   ha:Sig-tight {\n"
	         "    diameter = 64.0mil\n"
	         "    thickness = 10.0mil\n"
	         "    hole = 31.5mil\n"
	         "    clearance = 12.0mil\n"
	         "   }\n"
	         " }\n"
	         "\n"
	         " ha:meta {\n"
	         "   ha:size {\n"
	         "    thermal_scale = 0.500000\n"
	         "    x = " << block.boundary[XMAX]+offset_x << "mm\n" //TODO
	         "    y = " << block.boundary[YMAX]+offset_y << "mm\n"
	         "    isle_area_nm2 = 200000000.000000\n"
	         "   }\n"
	         "   ha:cursor {\n"
	         "    zoom = 1.000000\n"
	         "    x = 0.0\n"
	         "    y = 0.0\n"
	         "   }\n"
	         "   ha:drc {\n"
	         "    min_drill = 15.0mil\n"
	         "    min_ring = 10.0mil\n"
	         "    bloat = 12.0mil\n"
	         "    shrink = 9.0mil\n"
	         "    min_width = 10.0mil\n"
	         "    min_silk = 7.0mil\n"
	         "   }\n"
	         "   ha:grid {\n"
	         "    spacing = 0.1mm\n"
	         "    offs_x = 0.0\n"
	         "    offs_y = 0.0\n"
	         "   }\n"
	         " }\n"
	         "\n"
	         " ha:data {\n"
	         "  li:padstack_prototypes {\n"
	         "  }\n"
	         "\n"
	         "   li:objects {\n";

	for(shared_ptr<Element> it : block.elements) {
		if(!it->getActive())
			continue;
		type=it->getType();
		//if(type=="Pac" || type=="SUBST" || type=="MGAP" || type=="MOPEN" || type=="MSTEP")
			//nothing to do
		if(type=="MVIA") {
			f_out << "    ha:via." << n++ << " {"
			         "     x=" << it->getX()+offset_x << "mm; y=" << it->getY()+offset_y << "mm; hole=" << it->getD() << "mm; mask=0.0; thickness=" << it->getR() << "mm; clearance=0mm;\n"
			         "     ha:flags {\n"
			         "      via=1\n"
			         "     }\n"
			         "    }\n";
			}
		}

	f_out << "   }\n"
	         "   li:layers {\n"
	         "\n"
	         "    ha:top-sig {\n"
	         "     lid=0\n"
	         "     group=3\n"
	         "     ha:combining {     }\n"
	         "     visible=1\n"
	         "\n"
	         "      li:objects {\n";

	for(shared_ptr<Element> it : block.elements) {
		if(!it->getActive())
			continue;
		type=it->getType();
		if(type=="MCORN"
        || type=="MCROSS"
        || type=="MMBEND"
        || type=="MLIN"
        || type=="MRSTUB"
        || type=="MTEE") {
			f_out << "       ha:polygon." << n++ << " { clearance=0mm;\n"
			         "        li:geometry {\n"
			         "          ta:contour {\n";
			for(int i=0;i<it->getNpoint();i++) {
				f_out << "           { "
					  << it->getP(i, X, R, ABS)+offset_x << "mm; "
					  << it->getP(i, Y, R, ABS)+offset_y << "mm }\n";
				}
			f_out << "          }\n"
			         "        }\n"
			         "\n"
			         "        ha:flags {\n"
			         "         clearpoly=1\n"
			         "        }\n"
			         "       }\n";
		} else if(type=="MCOUPLED") {
			f_out << "       ha:polygon." << n++ << " { clearance=0mm;\n"
			         "        li:geometry {\n"
			         "          ta:contour {\n";
			for(int i=0;i<it->getNpoint()/2;i++) {
				f_out << "           { "
					  << it->getP(i, X, R, ABS)+offset_x << "mm; "
					  << it->getP(i, Y, R, ABS)+offset_y << "mm }\n";
				}
			f_out << "          }\n"
			         "        }\n"
			         "\n"
			         "        ha:flags {\n"
			         "         clearpoly=1\n"
			         "        }\n"
			         "       }\n";
			f_out << "       ha:polygon." << n++ << " { clearance=0mm;\n"
			         "        li:geometry {\n"
			         "          ta:contour {\n";
			for(int i=it->getNpoint()/2;i<it->getNpoint();i++) {
				f_out << "           { "
					  << it->getP(i, X, R, ABS)+offset_x << "mm; "
					  << it->getP(i, Y, R, ABS)+offset_y << "mm }\n";
				}
			f_out << "          }\n"
			         "        }\n"
			         "\n"
			         "        ha:flags {\n"
			         "         clearpoly=1\n"
			         "        }\n"
			         "       }\n";
			}
		}

	f_out << "      }\n"
	         "    }\n"
	         "\n"
	         "    ha:bottom-sig {\n"
	         "     lid=1\n"
	         "     group=10\n"
	         "     ha:combining {     }\n"
	         "     visible=1\n"
	         "\n"
	         "      li:objects {\n"
	         "      }\n"
	         "    }\n"
	         "\n"
	         "    ha:top-gnd {\n"
	         "     lid=2\n"
	         "     group=3\n"
	         "     ha:combining {     }\n"
	         "     visible=1\n"
	         "\n"
	         "      li:objects {\n"
	         "      }\n"
	         "    }\n"
	         "\n"
	         "    ha:bottom-gnd {\n"
	         "     lid=3\n"
	         "     group=10\n"
	         "     ha:combining {     }\n"
	         "     visible=1\n"
	         "\n"
	         "      li:objects {\n"
	         "      }\n"
	         "    }\n"
	         "\n"
	         "    ha:int-sig2 {\n"
	         "     lid=4\n"
	         "     group=7\n"
	         "     ha:combining {     }\n"
	         "     visible=1\n"
	         "\n"
	         "      li:objects {\n"
	         "      }\n"
	         "    }\n"
	         "\n"
	         "    ha:int-sig1 {\n"
	         "     lid=5\n"
	         "     group=5\n"
	         "     ha:combining {     }\n"
	         "     visible=1\n"
	         "\n"
	         "      li:objects {\n"
	         "      }\n"
	         "    }\n"
	         "\n"
	         "    ha:outline {\n"
	         "     lid=6\n"
	         "     group=9\n"
	         "     ha:combining {     }\n"
	         "     visible=1\n"
	         "\n"
	         "      li:objects {\n"
	         "      }\n"
	         "    }\n"
	         "\n"
	         "    ha:bottom-silk {\n"
	         "     lid=7\n"
	         "     group=12\n"
	         "     ha:combining { auto=1;     }\n"
	         "     visible=1\n"
	         "\n"
	         "      li:objects {\n"
	         "      }\n"
	         "    }\n"
	         "\n"
	         "    ha:top-silk {\n"
	         "     lid=8\n"
	         "     group=1\n"
	         "     ha:combining { auto=1;     }\n"
	         "     visible=1\n"
	         "\n"
	         "      li:objects {\n"
	         "      }\n"
	         "    }\n"
	         "\n"
	         "    ha:top-paste {\n"
	         "     lid=9\n"
	         "     group=0\n"
	         "     ha:combining { auto=1;     }\n"
	         "     visible=0\n"
	         "\n"
	         "      li:objects {\n"
	         "      }\n"
	         "    }\n"
	         "\n"
	         "    ha:top-mask {\n"
	         "     lid=10\n"
	         "     group=2\n"
	         "     ha:combining { sub=1; auto=1;     }\n"
	         "     visible=0\n"
	         "\n"
	         "      li:objects {\n"
	         "      }\n"
	         "    }\n"
	         "\n"
	         "    ha:bottom-mask {\n"
	         "     lid=11\n"
	         "     group=11\n"
	         "     ha:combining { sub=1; auto=1;     }\n"
	         "     visible=0\n"
	         "\n"
	         "      li:objects {\n"
	         "      }\n"
	         "    }\n"
	         "\n"
	         "    ha:bottom-paste {\n"
	         "     lid=12\n"
	         "     group=13\n"
	         "     ha:combining { auto=1;     }\n"
	         "     visible=0\n"
	         "\n"
	         "      li:objects {\n"
	         "      }\n"
	         "    }\n"
	         "   }\n"
	         " }\n"
	         "\n"
	         " ha:font {\n"
	         "  ha:geda_pcb {\n"
	         "   cell_width=1.270001mm; cell_height=1.397001mm;\n"
	         "   ha:symbols {\n"
	         "    ha:] {\n"
	         "     width=0.127001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=50.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:&5c {\n"
	         "     width=0.762001mm; height=1.143001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=15.0mil; x2=30.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:b {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=15.0mil; y1=50.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=20.0mil; y1=35.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=15.0mil; y1=30.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=15.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=0.0; y1=35.0mil; x2=5.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:c {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=35.0mil; x2=5.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=35.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:d {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=20.0mil; y1=10.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=15.0mil; y1=50.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=0.0; y1=35.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=0.0; y1=35.0mil; x2=5.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=15.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=15.0mil; y1=30.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:e {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=35.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=35.0mil; x2=5.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=15.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=15.0mil; y1=30.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=0.0; y1=40.0mil; x2=20.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=20.0mil; y1=40.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:f {\n"
	         "     width=0.381001mm; height=1.270001mm; delta=10.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=5.0mil; y1=15.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=15.0mil; x2=10.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=10.0mil; y1=10.0mil; x2=15.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=30.0mil; x2=10.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:g {\n"
	         "     width=0.508001mm; height=1.651001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=15.0mil; y1=30.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=15.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=35.0mil; x2=5.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=35.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=15.0mil; y1=50.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=0.0; y1=60.0mil; x2=5.0mil; y2=65.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=5.0mil; y1=65.0mil; x2=15.0mil; y2=65.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.9 {\n"
	         "       x1=15.0mil; y1=65.0mil; x2=20.0mil; y2=60.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.10 {\n"
	         "       x1=20.0mil; y1=30.0mil; x2=20.0mil; y2=60.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:h {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=35.0mil; x2=5.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=15.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=15.0mil; y1=30.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=20.0mil; y1=35.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:i {\n"
	         "     width=0.001um; height=1.270001mm; delta=10.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=20.0mil; x2=0.0; y2=21.0mil; thickness=10.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=35.0mil; x2=0.0; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:j {\n"
	         "     width=0.127001mm; height=1.651001mm; delta=10.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=5.0mil; y1=20.0mil; x2=5.0mil; y2=21.0mil; thickness=10.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=35.0mil; x2=5.0mil; y2=60.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=65.0mil; x2=5.0mil; y2=60.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:k {\n"
	         "     width=0.381001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=35.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=35.0mil; x2=10.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:l {\n"
	         "     width=0.127001mm; height=1.270001mm; delta=10.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:m {\n"
	         "     width=0.889001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=5.0mil; y1=35.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=35.0mil; x2=10.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=10.0mil; y1=30.0mil; x2=15.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=15.0mil; y1=30.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=20.0mil; y1=35.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=20.0mil; y1=35.0mil; x2=25.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=25.0mil; y1=30.0mil; x2=30.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=30.0mil; y1=30.0mil; x2=35.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=35.0mil; y1=35.0mil; x2=35.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.9 {\n"
	         "       x1=0.0; y1=30.0mil; x2=5.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:n {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=5.0mil; y1=35.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=35.0mil; x2=10.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=10.0mil; y1=30.0mil; x2=15.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=15.0mil; y1=30.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=20.0mil; y1=35.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=0.0; y1=30.0mil; x2=5.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:o {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=35.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=35.0mil; x2=5.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=15.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=15.0mil; y1=30.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=20.0mil; y1=35.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=15.0mil; y1=50.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:p {\n"
	         "     width=0.635001mm; height=1.651001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=5.0mil; y1=35.0mil; x2=5.0mil; y2=65.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=30.0mil; x2=5.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=5.0mil; y1=35.0mil; x2=10.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=10.0mil; y1=30.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=20.0mil; y1=30.0mil; x2=25.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=25.0mil; y1=35.0mil; x2=25.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=20.0mil; y1=50.0mil; x2=25.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=10.0mil; y1=50.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=5.0mil; y1=45.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:q {\n"
	         "     width=0.508001mm; height=1.651001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=20.0mil; y1=35.0mil; x2=20.0mil; y2=65.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=15.0mil; y1=30.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=15.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=35.0mil; x2=5.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=0.0; y1=35.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=15.0mil; y1=50.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:r {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=5.0mil; y1=35.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=35.0mil; x2=10.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=10.0mil; y1=30.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=30.0mil; x2=5.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:s {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=20.0mil; y1=50.0mil; x2=25.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=20.0mil; y1=40.0mil; x2=25.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=5.0mil; y1=40.0mil; x2=20.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=0.0; y1=35.0mil; x2=5.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=0.0; y1=35.0mil; x2=5.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=20.0mil; y1=30.0mil; x2=25.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:t {\n"
	         "     width=0.254001mm; height=1.270001mm; delta=10.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=5.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=45.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=25.0mil; x2=10.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:u {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=30.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=15.0mil; y1=50.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=20.0mil; y1=30.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:v {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=30.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=20.0mil; y1=30.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:w {\n"
	         "     width=0.762001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=30.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=10.0mil; y1=50.0mil; x2=15.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=15.0mil; y1=30.0mil; x2=15.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=15.0mil; y1=45.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=20.0mil; y1=50.0mil; x2=25.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=25.0mil; y1=50.0mil; x2=30.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=30.0mil; y1=30.0mil; x2=30.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:x {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=30.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=50.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:y {\n"
	         "     width=0.508001mm; height=1.651001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=30.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=20.0mil; y1=30.0mil; x2=20.0mil; y2=60.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=15.0mil; y1=65.0mil; x2=20.0mil; y2=60.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=5.0mil; y1=65.0mil; x2=15.0mil; y2=65.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=0.0; y1=60.0mil; x2=5.0mil; y2=65.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=15.0mil; y1=50.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:z {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=30.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=50.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=50.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:~ {\n"
	         "     width=0.635001mm; height=0.889001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=35.0mil; x2=5.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=10.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=10.0mil; y1=30.0mil; x2=15.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=15.0mil; y1=35.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=20.0mil; y1=35.0mil; x2=25.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:&7b {\n"
	         "     width=0.254001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=5.0mil; y1=15.0mil; x2=10.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=15.0mil; x2=5.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=30.0mil; x2=5.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=30.0mil; x2=5.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=5.0mil; y1=35.0mil; x2=5.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=5.0mil; y1=45.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:&7d {\n"
	         "     width=0.254001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=5.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=15.0mil; x2=5.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=5.0mil; y1=25.0mil; x2=10.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=5.0mil; y1=35.0mil; x2=10.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=5.0mil; y1=35.0mil; x2=5.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=0.0; y1=50.0mil; x2=5.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:| {\n"
	         "     width=0.001um; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:&20 {\n"
	         "     width=0.0; height=10.0mil; delta=18.0mil;\n"
	         "     li:objects {\n"
	         "     }\n"
	         "    }\n"
	         "    ha:&23 {\n"
	         "     width=0.508001mm; height=1.016001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=35.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=25.0mil; x2=20.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=15.0mil; y1=20.0mil; x2=15.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=5.0mil; y1=20.0mil; x2=5.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:&26 {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=15.0mil; x2=0.0; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=15.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=35.0mil; x2=15.0mil; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=10.0mil; y1=50.0mil; x2=20.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=0.0; y1=25.0mil; x2=25.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=10.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=10.0mil; y1=10.0mil; x2=15.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.9 {\n"
	         "       x1=15.0mil; y1=15.0mil; x2=15.0mil; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.10 {\n"
	         "       x1=0.0; y1=35.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:! {\n"
	         "     width=0.001um; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=45.0mil; x2=0.0; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:\" {\n"
	         "     width=0.254001mm; height=0.508001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=10.0mil; y1=10.0mil; x2=10.0mil; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:$ {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=15.0mil; y1=15.0mil; x2=20.0mil; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=15.0mil; x2=15.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=20.0mil; x2=5.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=20.0mil; x2=0.0; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=0.0; y1=25.0mil; x2=5.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=15.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=15.0mil; y1=30.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=20.0mil; y1=35.0mil; x2=20.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=15.0mil; y1=45.0mil; x2=20.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.9 {\n"
	         "       x1=5.0mil; y1=45.0mil; x2=15.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.10 {\n"
	         "       x1=0.0; y1=40.0mil; x2=5.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.11 {\n"
	         "       x1=10.0mil; y1=10.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:% {\n"
	         "     width=1.016001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=15.0mil; x2=0.0; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=15.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=10.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=10.0mil; y1=10.0mil; x2=15.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=15.0mil; y1=15.0mil; x2=15.0mil; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=10.0mil; y1=25.0mil; x2=15.0mil; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=5.0mil; y1=25.0mil; x2=10.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=0.0; y1=20.0mil; x2=5.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=0.0; y1=50.0mil; x2=40.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.9 {\n"
	         "       x1=35.0mil; y1=50.0mil; x2=40.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.10 {\n"
	         "       x1=40.0mil; y1=40.0mil; x2=40.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.11 {\n"
	         "       x1=35.0mil; y1=35.0mil; x2=40.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.12 {\n"
	         "       x1=30.0mil; y1=35.0mil; x2=35.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.13 {\n"
	         "       x1=25.0mil; y1=40.0mil; x2=30.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.14 {\n"
	         "       x1=25.0mil; y1=40.0mil; x2=25.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.15 {\n"
	         "       x1=25.0mil; y1=45.0mil; x2=30.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.16 {\n"
	         "       x1=30.0mil; y1=50.0mil; x2=35.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:' {\n"
	         "     width=0.254001mm; height=0.508001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=20.0mil; x2=10.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:( {\n"
	         "     width=0.127001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=15.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=15.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:) {\n"
	         "     width=0.127001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=5.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=15.0mil; x2=5.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=50.0mil; x2=5.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:* {\n"
	         "     width=0.508001mm; height=1.016001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=20.0mil; x2=20.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=40.0mil; x2=20.0mil; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=30.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=10.0mil; y1=20.0mil; x2=10.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:+ {\n"
	         "     width=0.508001mm; height=1.016001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=30.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=10.0mil; y1=20.0mil; x2=10.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:, {\n"
	         "     width=0.254001mm; height=1.524001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=60.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:- {\n"
	         "     width=0.508001mm; height=0.762001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=30.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:. {\n"
	         "     width=0.127001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=50.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:0 {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=15.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=15.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=15.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=15.0mil; y1=10.0mil; x2=20.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=20.0mil; y1=15.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=15.0mil; y1=50.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=0.0; y1=40.0mil; x2=20.0mil; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:1 {\n"
	         "     width=0.381001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=18.0mil; x2=8.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=8.0mil; y1=10.0mil; x2=8.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:2 {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=15.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=20.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=20.0mil; y1=10.0mil; x2=25.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=25.0mil; y1=15.0mil; x2=25.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=0.0; y1=50.0mil; x2=25.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=0.0; y1=50.0mil; x2=25.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:3 {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=15.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=15.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=15.0mil; y1=10.0mil; x2=20.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=15.0mil; y1=50.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=5.0mil; y1=28.0mil; x2=15.0mil; y2=28.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=20.0mil; y1=15.0mil; x2=20.0mil; y2=23.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=20.0mil; y1=33.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.9 {\n"
	         "       x1=20.0mil; y1=33.0mil; x2=15.0mil; y2=28.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.10 {\n"
	         "       x1=20.0mil; y1=23.0mil; x2=15.0mil; y2=28.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:4 {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=35.0mil; x2=20.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=35.0mil; x2=25.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=20.0mil; y1=10.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:5 {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=20.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=30.0mil; x2=5.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=5.0mil; y1=25.0mil; x2=15.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=15.0mil; y1=25.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=20.0mil; y1=30.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=15.0mil; y1=50.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:6 {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=15.0mil; y1=10.0mil; x2=20.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=15.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=15.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=15.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=15.0mil; y1=28.0mil; x2=20.0mil; y2=33.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=0.0; y1=28.0mil; x2=15.0mil; y2=28.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=15.0mil; y1=50.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.9 {\n"
	         "       x1=20.0mil; y1=33.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:7 {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=25.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=10.0mil; x2=25.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:8 {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=37.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=37.0mil; x2=7.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=7.0mil; y1=30.0mil; x2=13.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=13.0mil; y1=30.0mil; x2=20.0mil; y2=37.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=20.0mil; y1=37.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=15.0mil; y1=50.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=0.0; y1=23.0mil; x2=7.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.9 {\n"
	         "       x1=0.0; y1=15.0mil; x2=0.0; y2=23.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.10 {\n"
	         "       x1=0.0; y1=15.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.11 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=15.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.12 {\n"
	         "       x1=15.0mil; y1=10.0mil; x2=20.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.13 {\n"
	         "       x1=20.0mil; y1=15.0mil; x2=20.0mil; y2=23.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.14 {\n"
	         "       x1=13.0mil; y1=30.0mil; x2=20.0mil; y2=23.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:9 {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=20.0mil; y1=15.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=15.0mil; y1=10.0mil; x2=20.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=15.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=0.0; y1=15.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=0.0; y1=15.0mil; x2=0.0; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=0.0; y1=25.0mil; x2=5.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:< {\n"
	         "     width=0.254001mm; height=1.016001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=30.0mil; x2=10.0mil; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=30.0mil; x2=10.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:> {\n"
	         "     width=0.254001mm; height=1.016001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=20.0mil; x2=10.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=40.0mil; x2=10.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:? {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=10.0mil; y1=30.0mil; x2=10.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=10.0mil; y1=45.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=15.0mil; x2=0.0; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=15.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=15.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=15.0mil; y1=10.0mil; x2=20.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=20.0mil; y1=15.0mil; x2=20.0mil; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=10.0mil; y1=30.0mil; x2=20.0mil; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:@ {\n"
	         "     width=1.270001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=40.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=10.0mil; y1=50.0mil; x2=40.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=50.0mil; y1=35.0mil; x2=50.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=50.0mil; y1=10.0mil; x2=40.0mil; y2=0.0; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=40.0mil; y1=0.0; x2=10.0mil; y2=0.0; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=10.0mil; y1=0.0; x2=0.0; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=15.0mil; y1=20.0mil; x2=15.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=15.0mil; y1=30.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.9 {\n"
	         "       x1=20.0mil; y1=35.0mil; x2=30.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.10 {\n"
	         "       x1=30.0mil; y1=35.0mil; x2=35.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.11 {\n"
	         "       x1=35.0mil; y1=30.0mil; x2=40.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.12 {\n"
	         "       x1=35.0mil; y1=30.0mil; x2=35.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.13 {\n"
	         "       x1=35.0mil; y1=20.0mil; x2=30.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.14 {\n"
	         "       x1=20.0mil; y1=15.0mil; x2=30.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.15 {\n"
	         "       x1=20.0mil; y1=15.0mil; x2=15.0mil; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.16 {\n"
	         "       x1=40.0mil; y1=35.0mil; x2=50.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:A {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=20.0mil; x2=0.0; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=20.0mil; x2=7.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=7.0mil; y1=10.0mil; x2=18.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=18.0mil; y1=10.0mil; x2=25.0mil; y2=20.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=25.0mil; y1=20.0mil; x2=25.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=0.0; y1=30.0mil; x2=25.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:B {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=50.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=20.0mil; y1=50.0mil; x2=25.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=25.0mil; y1=33.0mil; x2=25.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=20.0mil; y1=28.0mil; x2=25.0mil; y2=33.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=5.0mil; y1=28.0mil; x2=20.0mil; y2=28.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=0.0; y1=10.0mil; x2=20.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=20.0mil; y1=10.0mil; x2=25.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=25.0mil; y1=15.0mil; x2=25.0mil; y2=23.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.9 {\n"
	         "       x1=20.0mil; y1=28.0mil; x2=25.0mil; y2=23.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:C {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=7.0mil; y1=50.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=43.0mil; x2=7.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=17.0mil; x2=0.0; y2=43.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=17.0mil; x2=7.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=7.0mil; y1=10.0mil; x2=20.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:D {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=18.0mil; y1=10.0mil; x2=25.0mil; y2=17.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=25.0mil; y1=17.0mil; x2=25.0mil; y2=43.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=18.0mil; y1=50.0mil; x2=25.0mil; y2=43.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=0.0; y1=50.0mil; x2=18.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=0.0; y1=10.0mil; x2=18.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:E {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=28.0mil; x2=15.0mil; y2=28.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=50.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=10.0mil; x2=20.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:F {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=10.0mil; x2=20.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=28.0mil; x2=15.0mil; y2=28.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:G {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=20.0mil; y1=10.0mil; x2=25.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=20.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=15.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=15.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=20.0mil; y1=50.0mil; x2=25.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=25.0mil; y1=35.0mil; x2=25.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=20.0mil; y1=30.0mil; x2=25.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.9 {\n"
	         "       x1=10.0mil; y1=30.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:H {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=25.0mil; y1=10.0mil; x2=25.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=30.0mil; x2=25.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:I {\n"
	         "     width=0.254001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=10.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=50.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:J {\n"
	         "     width=0.381001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=7.0mil; y1=10.0mil; x2=15.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=15.0mil; y1=10.0mil; x2=15.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=10.0mil; y1=50.0mil; x2=15.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=0.0; y1=45.0mil; x2=0.0; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:K {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=30.0mil; x2=20.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=30.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:L {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=50.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:M {\n"
	         "     width=0.762001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=10.0mil; x2=15.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=15.0mil; y1=30.0mil; x2=30.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=30.0mil; y1=10.0mil; x2=30.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:&2f {\n"
	         "     width=0.762001mm; height=1.143001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=45.0mil; x2=30.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:&3a {\n"
	         "     width=0.127001mm; height=0.889001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=25.0mil; x2=5.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=35.0mil; x2=5.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:&3b {\n"
	         "     width=0.254001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=50.0mil; x2=10.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=10.0mil; y1=25.0mil; x2=10.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:&3d {\n"
	         "     width=0.508001mm; height=0.889001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=25.0mil; x2=20.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=35.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:O {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=15.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=15.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=15.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=15.0mil; y1=10.0mil; x2=20.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=20.0mil; y1=15.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=15.0mil; y1=50.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:P {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=10.0mil; x2=20.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=20.0mil; y1=10.0mil; x2=25.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=25.0mil; y1=15.0mil; x2=25.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=20.0mil; y1=30.0mil; x2=25.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:N {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=10.0mil; x2=25.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=25.0mil; y1=10.0mil; x2=25.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:R {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=20.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=20.0mil; y1=10.0mil; x2=25.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=25.0mil; y1=15.0mil; x2=25.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=20.0mil; y1=30.0mil; x2=25.0mil; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=13.0mil; y1=30.0mil; x2=25.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:S {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=20.0mil; y1=10.0mil; x2=25.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=20.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=15.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=15.0mil; x2=0.0; y2=25.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=0.0; y1=25.0mil; x2=5.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=20.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=20.0mil; y1=30.0mil; x2=25.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=25.0mil; y1=35.0mil; x2=25.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=20.0mil; y1=50.0mil; x2=25.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.9 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.10 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:Q {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=15.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=15.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=15.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=15.0mil; y1=10.0mil; x2=20.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=20.0mil; y1=15.0mil; x2=20.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=10.0mil; y1=50.0mil; x2=20.0mil; y2=40.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=10.0mil; y1=35.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:U {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=15.0mil; y1=50.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=20.0mil; y1=10.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:V {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=10.0mil; y1=50.0mil; x2=20.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:T {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=20.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=10.0mil; y1=10.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:X {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=50.0mil; x2=25.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=10.0mil; x2=25.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:Y {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=10.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=10.0mil; y1=30.0mil; x2=20.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=10.0mil; y1=30.0mil; x2=10.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:W {\n"
	         "     width=0.762001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=30.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=15.0mil; y1=30.0mil; x2=25.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=25.0mil; y1=50.0mil; x2=30.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=30.0mil; y1=30.0mil; x2=30.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:[ {\n"
	         "     width=0.127001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=10.0mil; x2=0.0; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=50.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:^ {\n"
	         "     width=0.254001mm; height=0.381001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=15.0mil; x2=5.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=10.0mil; x2=10.0mil; y2=15.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:Z {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=10.0mil; x2=25.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=0.0; y1=50.0mil; x2=25.0mil; y2=10.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=50.0mil; x2=25.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:a {\n"
	         "     width=0.635001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=15.0mil; y1=30.0mil; x2=20.0mil; y2=35.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.1 {\n"
	         "       x1=5.0mil; y1=30.0mil; x2=15.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.2 {\n"
	         "       x1=0.0; y1=35.0mil; x2=5.0mil; y2=30.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.3 {\n"
	         "       x1=0.0; y1=35.0mil; x2=0.0; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.4 {\n"
	         "       x1=0.0; y1=45.0mil; x2=5.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.5 {\n"
	         "       x1=20.0mil; y1=30.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.6 {\n"
	         "       x1=20.0mil; y1=45.0mil; x2=25.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.7 {\n"
	         "       x1=5.0mil; y1=50.0mil; x2=15.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "      ha:line.8 {\n"
	         "       x1=15.0mil; y1=50.0mil; x2=20.0mil; y2=45.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "    ha:_ {\n"
	         "     width=0.508001mm; height=1.270001mm; delta=12.0mil;\n"
	         "     li:objects {\n"
	         "      ha:line.0 {\n"
	         "       x1=0.0; y1=50.0mil; x2=20.0mil; y2=50.0mil; thickness=8.0mil;\n"
	         "      }\n"
	         "     }\n"
	         "    }\n"
	         "   }\n"
	         "   id = 0\n"
	         "  }\n"
	         " }\n"
	         "\n"
	         " ha:netlists {\n"
	         "   li:input {\n"
	         "   }\n"
	         " }\n"
	         " ha:layer_stack {\n"
	         "  li:groups {\n"
	         "   ha:0 {\n"
	         "    name = top_paste\n"
	         "    ha:type { top=1; paste=1;    }\n"
	         "    li:layers { 9;    }\n"
	         "   }\n"
	         "   ha:1 {\n"
	         "    name = top_silk\n"
	         "    ha:type { silk=1; top=1;    }\n"
	         "    li:layers { 8;    }\n"
	         "   }\n"
	         "   ha:2 {\n"
	         "    name = top_mask\n"
	         "    ha:type { top=1; mask=1;    }\n"
	         "    li:layers { 10;    }\n"
	         "   }\n"
	         "   ha:3 {\n"
	         "    name = top_copper\n"
	         "    ha:type { copper=1; top=1;    }\n"
	         "    li:layers { 0; 2;    }\n"
	         "   }\n"
	         "   ha:4 {\n"
	         "    name = grp_4\n"
	         "    ha:type { substrate=1; intern=1;    }\n"
	         "    li:layers {    }\n"
	         "   }\n"
	         "   ha:5 {\n"
	         "    name = Intern\n"
	         "    ha:type { copper=1; intern=1;    }\n"
	         "    li:layers { 5;    }\n"
	         "   }\n"
	         "   ha:6 {\n"
	         "    name = grp_6\n"
	         "    ha:type { substrate=1; intern=1;    }\n"
	         "    li:layers {    }\n"
	         "   }\n"
	         "   ha:7 {\n"
	         "    name = Intern\n"
	         "    ha:type { copper=1; intern=1;    }\n"
	         "    li:layers { 4;    }\n"
	         "   }\n"
	         "   ha:8 {\n"
	         "    name = grp_8\n"
	         "    ha:type { substrate=1; intern=1;    }\n"
	         "    li:layers {    }\n"
	         "   }\n"
	         "   ha:9 {\n"
	         "    name = global outline\n"
	         "    ha:type { outline=1; intern=1;    }\n"
	         "    li:layers { 6;    }\n"
	         "   }\n"
	         "   ha:10 {\n"
	         "    name = bottom_copper\n"
	         "    ha:type { bottom=1; copper=1;    }\n"
	         "    li:layers { 1; 3;    }\n"
	         "   }\n"
	         "   ha:11 {\n"
	         "    name = bottom_mask\n"
	         "    ha:type { bottom=1; mask=1;    }\n"
	         "    li:layers { 11;    }\n"
	         "   }\n"
	         "   ha:12 {\n"
	         "    name = bottom_silk\n"
	         "    ha:type { silk=1; bottom=1;    }\n"
	         "    li:layers { 7;    }\n"
	         "   }\n"
	         "   ha:13 {\n"
	         "    name = bottom_paste\n"
	         "    ha:type { bottom=1; paste=1;    }\n"
	         "    li:layers { 12;    }\n"
	         "   }\n"
	         "  }\n"
	         " }\n"
	         " li:pcb-rnd-conf-v1 {\n"
	         "  ha:overwrite {\n"
	         "   ha:design {\n"
	         "    min_ring = 10.00 mil\n"
	         "    clearance = 0 mil\n"
	         "    via_thickness = 2.0000 mm\n"
	         "    via_drilling_hole = 31.50 mil\n"
	         "    min_slk = 0 mil\n"
	         "    max_height = 5.00000 in\n"
	         "    line_thickness = 0 mil\n"
	         "    shrink = 9.00 mil\n"
	         "    poly_isle_area = 200000000.2\n"
	         "    max_width = 6.00000 in\n"
	         "    min_wid = 0 mil\n"
	         "    bloat = 12.00 mil\n"
	         "    min_drill = 15.00 mil\n"
	         "   }\n"
	         "   ha:editor {\n"
	         "    grid_unit = mm\n"
	         "     grid = 0.01 mil\n"
	         "   }\n"
	         "  }\n"
	         " }\n"
	         "}\n";
	}

//******************************************************************************
int LayoutWriter::check_m(void) {
	if(data.is_volume_error) {
		log_err << data.volume_error;
		return(1);
		}

	bool is_first_sp=true;
	for(shared_ptr<Element> it : data.tab_all) {
		if(it->getType()==".SP") {
			if(is_first_sp==false) {
				log_err << "ERROR : More than 1 active S parameter simulation.\n";
				return(1);
				}
			is_first_sp=false;
			}
		}

	if(data.oems_nf2ff_center!="") {
		bool is_nf2ff_center_valid=false;
		for(shared_ptr<Element> it : data.tab_all) {
			if(it->getLabel()==data.oems_nf2ff_center) {
				is_nf2ff_center_valid=true;
				break;
				}
			}
		if(!is_nf2ff_center_valid) {
			log_err << "ERROR : Invalid NF2FF center : " << data.oems_nf2ff_center << ".\n";
			return(1);
			}
		}

	return(0);
	}

//******************************************************************************
void LayoutWriter::write_m(Block& block, std::ofstream& f_out, long double const offset_x, long double const offset_y, std::string const& name) {
	string type;
	string label;
	long double extrem_pos_zmin=0.0;
	long double extrem_pos_zmax=0.0;

	OemsMesh mesh(block.elements);

	// Need to store ports ordered.
	vector<pair<unsigned int, shared_ptr<Element>>> ports;
	for(shared_ptr<Element> it : block.elements) {
		if(it->getType()=="Pac") {
			ports.push_back(make_pair((unsigned int)it->getN(), it));
			}
		}
	sort(begin(ports), end(ports));

	f_out << "#!/usr/bin/octave\n"
	         "\n"
	         "%%%% OpenEMS script generated by Qucs-RFlayout from : " << name << ".sch\n"
	         "\n"
	         "clear;\n"
	         "close all;\n"
	         "\n"
	         "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% SYSTEM\n"
	         "\n"
	         "%%%% ARGUMENTS\n"
	         "arg_only_preprocess = false;\n"
	         "arg_only_postprocess = false;\n"
	         "arg_no_preprocess = false;\n"
	         "arg_no_postprocess = false;\n"
	         "flag_clean = false;\n"
	         "flag_clean_result = false;\n"
	         "flag_clean_simulation = false;\n"
	         "flag_gui = true;\n"
	         "flag_process = true;\n"
	         "flag_preprocess = true;\n"
	         "flag_postprocess = true;\n"
	         "flag_legend_out = false;\n"
	         "flag_conductingsheet = true;\n"
	         "flag_f = [];\n"
	         "flag_f_max = num2str([]);\n"
	         "flag_f_min = num2str([]);\n"
	         "flag_f_equal_s = num2str([]);\n"
	         "flag_f_equal_v = [];\n"
	         "flag_nf2ff = false;\n"
	         "flag_nf2ff_mode = 0;\n"
	         "flag_nf2ff_3d = false;\n"
	         "flag_nf2ff_frames = 0;\n"
	         "flag_nf2ff_delay = '30';\n"
	         "flag_nf2ff_phistep = 5;\n"
	         "flag_nf2ff_thetastep = 5;\n"
	         "flag_dump = false;\n"
	         "flag_mur = false;\n"
	         "flag_mesh = true;\n"
	         "flag_highresmesh = true;\n"
	         "flag_metalresmesh = true;\n"
	         "flag_smoothmesh = true;\n";
	for(pair<unsigned int, shared_ptr<Element>> port : ports) {
		f_out << "flag_active_port" << port.first << " = " << (port==ports.front() ? "true" : "false") << ";\n";
		}
	f_out << "arg_list = argv();\n"
	         "i = 1;\n"
	         "while i <= nargin\n"
	         "\tif strcmp(arg_list{i}, '--help') || strcmp(arg_list{i}, '-h')\n"
	         "\t\tdisp('OpenEMS Octave script generated by Qucs-RFlayout from : " << name << ".sch');\n"
	         "\t\tdisp(['Usage:  ./', program_name(), ' <options>']);\n"
	         "\t\tdisp(['        octave ', program_name(), ' <option>']);\n"
	         "\t\tdisp('');\n"
	         "\t\tdisp('General options:');\n"
	         "\t\tdisp(\"\\t-h, --help             Display this help and exit.\");\n"
	         "\t\tdisp(\"\\t-c, --clean            Remove all result and simulation files.\");\n"
	         "\t\tdisp(\"\\t-cr, --clean-result    Remove all result files.\");\n"
	         "\t\tdisp(\"\\t-cs, --clean-sim       Remove all simulation files.\");\n"
	         "\t\tdisp(\"\\t--<N>                  Enable a port. 'N' is a port number. By default the first port is enabled.\");\n"
	         "\t\tdisp(\"\\t--no-<N>               Disable a port. 'N' is a port number. By default all other ports are disabled.\");\n"
	         "\t\tdisp(\"\\t                       Possible port numbers are : ";
	for(pair<unsigned int, shared_ptr<Element>> port : ports) {
		f_out << port.first;
		if(port!=ports.back()) {
			f_out << ", ";
			}
		}
	f_out << ".\");\n"
	         "\t\tdisp('');\n"
	         "\t\tdisp('Control options:');\n"
	         "\t\tdisp(\"\\t--only-preprocess      Only structure and mesh construction.\");\n"
	         "\t\tdisp(\"\\t--only-postprocess     Only process simulation datas to produce graphics and far field calculation.\");\n"
	         "\t\tdisp(\"\\t--no-preprocess        Do not execute anything before siulation.\");\n"
//	         "\t\tdisp(\"\\t--no-process           Do not execute simulation.\");\n"
	         "\t\tdisp(\"\\t--no-postprocess       Do not execute anything after simulation.\");\n"
	         "\t\tdisp(\"\\t--no-gui               Do not open AppCSXCAD.\");\n"
	         "\t\tdisp('');\n"
	         "\t\tdisp('Preprocessing options:');\n"
	         "\t\tdisp(\"\\t--no-dump              Do not dump Et field, Ht field, current and current density.\");\n"
	         "\t\tdisp(\"\\t--no-conductingsheet   Use 3D perfect metal boxes instead of 2D conducting sheets.\");\n"
	         "\t\tdisp(\"\\t--no-highresmesh       No high resolution mesh for non orthogonal shapes.\");\n"
	         "\t\tdisp(\"\\t--no-metalresmesh      No particular mesh lines (thirds rule) at metal resolution for orthogonal shapes.\");\n"
	         "\t\tdisp(\"\\t--no-smoothmesh        Only particular mesh lines.\");\n"
	         "\t\tdisp(\"\\t--no-mesh              Do not mesh any shape.\");\n"
	         "\t\tdisp(\"\\t--mur                  Use MUR boundary condition instead of PML_8. Results and simulation time may significantly vary.\");\n"
	         "\t\tdisp('');\n"
	         "\t\tdisp('Postprocessing options:');\n"
	         "\t\tdisp(\"\\t--legend-out           Put legend boxes outside graphics\");\n"
	         "\t\tdisp(\"\\t--no-nf2ff             Do not calcul far field radiation.\");\n"
	         "\t\tdisp(\"\\t--nf2ff-force          Force NF2FF calculation.\");\n"
//	         "\t\tdisp(\"\\t--nf2ff-center         Place the NF2FF calculation center. Should be placed at the radiating element center.\");\n" TODO qrfl args
//	         "\t\tdisp(\"\\t                       By default NF2FF center is the simulation box center.\");\n"
	         "\t\tdisp(\"\\t--f <F>                Set frequency to place markers and compute far field radiations.\");\n"
	         "\t\tdisp(\"\\t                       Can be called multiple times. Example : '--f 3.1e09'\");\n"
	         "\t\tdisp(\"\\t--f-max s<A><B>        Place markers and compute far field radiations at the frequency for which the specified\");\n"
	         "\t\tdisp(\"\\t                       S parameter is maximal. A and B are port numbers, B must be active. Can be called multiple times.\");\n"
	         "\t\tdisp(\"\\t--f-min s<A><B>        Place markers and compute far field radiations at the frequency for which the specified\");\n"
	         "\t\tdisp(\"\\t                       S parameter is minimal. A and B are port numbers, B must be active. Can be called multiple times.\");\n"
	         "\t\tdisp(\"\\t--f-equal s<A><B> <F>  Place markers and compute far field radiations at the frequency for which the specified\");\n"
	         "\t\tdisp(\"\\t                       S parameter is equal to the specified value (in dB). Can be called multiple times.\");\n"
	         "\t\tdisp(\"\\t                       Example : '--f-equal s21 -3.5'.\");\n"
	         "\t\tdisp(\"\\t--nf2ff-3d             Enable 3D far field representation (may be long).\");\n"
	         "\t\tdisp(\"\\t--nf2ff-frames <I>     Number of 3D frames to merge in a .gif. ImageMagick is required. Default (0, 1 or nothing) : use\");\n"
	         "\t\tdisp(\"\\t                       default or --f* args specified frequencies and no .gif generated.\");\n"
	         "\t\tdisp(\"\\t--nf2ff-delay          Delay between each frames (in ms). Cf. convert's '-delay' argument. Default : 30\");\n"
	         "\t\tdisp(\"\\t--nf2ff-phistep <I>    Set phi angle (elevation) step for 3D far field. I is in degree, default is 5.\");\n"
	         "\t\tdisp(\"\\t--nf2ff-thetastep <I>  Set theta angle (azimuth) step for 3D far field. I is in degree, default is 5.\");\n"
	         "\t\tdisp(\"\\t--nf2ff-anglestep <I>  Set phi & theta angle steps for 3D far field. I is in degree.\");\n"
	         "\t\treturn;\n"
	         "\telseif strcmp(arg_list{i}, '--clean') || strcmp(arg_list{i}, '-c')\n"
	         "\t\tflag_clean = true;\n"
	         "\telseif strcmp(arg_list{i}, '--clean-result') || strcmp(arg_list{i}, '-cr')\n"
	         "\t\tflag_clean_result = true;\n"
	         "\telseif strcmp(arg_list{i}, '--clean-sim') || strcmp(arg_list{i}, '-cs')\n"
	         "\t\tflag_clean_simulation = true;\n"
	         "\telseif strcmp(arg_list{i}, '--only-preprocess')\n"
	         "\t\targ_only_preprocess = true;\n"
	         "\t\tflag_process = false;\n"
	         "\t\tflag_postprocess = false;\n"
	         "\telseif strcmp(arg_list{i}, '--only-postprocess')\n"
	         "\t\targ_only_postprocess = true;\n"
	         "\t\tflag_preprocess = false;\n"
	         "\t\tflag_process = false;\n"
	         "\telseif strcmp(arg_list{i}, '--no-preprocess')\n"
	         "\t\targ_no_preprocess = true;\n"
	         "\t\tflag_preprocess = false;\n"
	         "\telseif strcmp(arg_list{i}, '--no-gui')\n"
	         "\t\tflag_gui = false;\n"
//	         "\telseif strcmp(arg_list{i}, '--no-process')\n"
//	         "\t\tflag_process = false;\n"
	         "\telseif strcmp(arg_list{i}, '--no-postprocess')\n"
	         "\t\targ_no_postprocess = true;\n"
	         "\t\tflag_postprocess = false;\n"
	         "\telseif strcmp(arg_list{i}, '--f')\n"
	         "\t\tflag_f = [flag_f, str2num(arg_list{i + 1})];\n"
	         "\t\ti = i + 1;\n"
	         "\telseif strcmp(arg_list{i}, '--f-max')\n"
	         "\t\tflag_f_max = [flag_f_max; arg_list{i + 1}];\n"
	         "\t\ti = i + 1;\n"
	         "\telseif strcmp(arg_list{i}, '--f-min')\n"
	         "\t\tflag_f_min = [flag_f_min; arg_list{i + 1}];\n"
	         "\t\ti = i + 1;\n"
	         "\telseif strcmp(arg_list{i}, '--f-equal')\n"
	         "\t\tflag_f_equal_s = [flag_f_equal_s; arg_list{i + 1}];\n"
	         "\t\tflag_f_equal_v = [flag_f_equal_v, str2num(arg_list{i + 2})];\n"
	         "\t\ti = i + 2;\n"
	         "\telseif strcmp(arg_list{i}, '--legend-out')\n"
	         "\t\tflag_legend_out = true;\n"
	         "\telseif strcmp(arg_list{i}, '--no-nf2ff')\n"
	         "\t\tflag_nf2ff = false;\n"
	         "\telseif strcmp(arg_list{i}, '--nf2ff-force')\n"
	         "\t\tflag_nf2ff_mode = 1;\n"
	         "\telseif strcmp(arg_list{i}, '--nf2ff-3d')\n"
	         "\t\tflag_nf2ff_3d = true;\n"
	         "\telseif strcmp(arg_list{i}, '--nf2ff-frames')\n"
	         "\t\tflag_nf2ff_frames = str2num(arg_list{i + 1});\n"
	         "\t\ti = i + 1;\n"
	         "\telseif strcmp(arg_list{i}, '--nf2ff-delay')\n"
	         "\t\tflag_nf2ff_delay = arg_list{i + 1};\n"
	         "\t\ti = i + 1;\n"
	         "\telseif strcmp(arg_list{i}, '--nf2ff-phistep')\n"
	         "\t\tflag_nf2ff_phistep = str2num(arg_list{i + 1});\n"
	         "\t\ti = i + 1;\n"
	         "\telseif strcmp(arg_list{i}, '--nf2ff-thetastep')\n"
	         "\t\tflag_nf2ff_thetastep = str2num(arg_list{i + 1});\n"
	         "\t\ti = i + 1;\n"
	         "\telseif strcmp(arg_list{i}, '--nf2ff-anglestep')\n"
	         "\t\tflag_nf2ff_phistep = str2num(arg_list{i + 1});\n"
	         "\t\tflag_nf2ff_thetastep = str2num(arg_list{i + 1});\n"
	         "\t\ti = i + 1;\n"
	         "\telseif strcmp(arg_list{i}, '--no-dump')\n"
	         "\t\tflag_dump = false;\n"
	         "\telseif strcmp(arg_list{i}, '--mur')\n"
	         "\t\tflag_mur = true;\n"
	         "\telseif strcmp(arg_list{i}, '--no-conductingsheet')\n"
	         "\t\tflag_conductingsheet = false;\n"
	         "\telseif strcmp(arg_list{i}, '--no-mesh')\n"
	         "\t\tflag_mesh = false;\n"
	         "\telseif strcmp(arg_list{i}, '--no-highresmesh')\n"
	         "\t\tflag_highresmesh = false;\n"
	         "\telseif strcmp(arg_list{i}, '--no-metalresmesh')\n"
	         "\t\tflag_metalresmesh = false;\n"
	         "\telseif strcmp(arg_list{i}, '--no-smoothmesh')\n"
	         "\t\tflag_smoothmesh = false;\n";
	for(pair<unsigned int, shared_ptr<Element>> it : ports) {
		f_out << "\telseif strcmp(arg_list{i}, '--" << it.first << "')\n"
		         "\t\tflag_active_port" << it.first << " = true;\n"
		         "\telseif strcmp(arg_list{i}, '--no-" << it.first << "')\n"
		         "\t\tflag_active_port" << it.first << " = false;\n";
		}
	f_out << "\telse\n"
	         "\t\tdisp(['ERROR : Unknown argument : ', arg_list{i}]);\n"
	         "\t\treturn;\n"
	         "\tendif\n"
	         "\ti = i + 1;\n"
	         "endwhile\n"
	         "if arg_only_preprocess && arg_only_postprocess\n"
	         "\tdisp('ERROR : --only-preprocess and --only-postprocess are not compatible.');\n"
	         "\treturn;\n"
	         "endif\n"
	         "if arg_only_preprocess && arg_no_preprocess\n"
	         "\tdisp('ERROR : --only-preprocess and --no-preprocess are not compatible.');\n"
	         "\treturn;\n"
	         "endif\n"
	         "if arg_only_postprocess && arg_no_postprocess\n"
	         "\tdisp('ERROR : --only-postprocess and --no-postprocess are not compatible.');\n"
	         "\treturn;\n"
	         "endif\n"
	         "if flag_mesh == false && arg_only_preprocess == false\n"
	         "\tdisp('ERROR : --no-mesh only works with --only-preprocess.');\n"
	         "\treturn;\n"
	         "endif\n"
	         "if flag_smoothmesh == false && arg_only_preprocess == false\n"
	         "\tdisp('ERROR : --no-smoothmesh only works with --only-preprocess.');\n"
	         "\treturn;\n"
	         "endif\n"
	         "if exist('flag_f_max', 'var')\n"
	         "\tfor i = 1:rows(flag_f_max)\n"
	         "\t\tif exist('flag_f_max', 'var') && numel(flag_f_max(i, :)) == 3 && flag_f_max(i, 1) == 's' ...\n"
	         "\t\t&& exist(['flag_active_port', flag_f_max(i, 2)]) ...\n"
	         "\t\t&& exist(['flag_active_port', flag_f_max(i, 3)])\n"
	         "\t\t\tif eval(['flag_active_port', flag_f_max(i, 3)]) == false\n"
	         "\t\t\t\tdisp(['ERROR : --f-max ', flag_f_max(i, :), ' : port ', flag_f_max(i, 3), ' is not an active port.']);\n"
	         "\t\t\t\treturn;\n"
	         "\t\t\tendif\n"
	         "\t\telse\n"
	         "\t\t\tdisp(['ERROR : --f-max ', flag_f_max(i, :), ' : incorrect argument.']);\n"
	         "\t\t\treturn;\n"
	         "\t\tendif\n"
	         "\tendfor\n"
	         "endif\n"
	         "if exist('flag_f_min', 'var')\n"
	         "\tfor i = 1:rows(flag_f_min)\n"
	         "\t\tif numel(flag_f_min(i, :)) == 3 && flag_f_min(i, 1) == 's' ...\n"
	         "\t\t&& exist(['flag_active_port', flag_f_min(i, 2)]) ...\n"
	         "\t\t&& exist(['flag_active_port', flag_f_min(i, 3)])\n"
	         "\t\t\tif eval(['flag_active_port', flag_f_min(i, 3)]) == false\n"
	         "\t\t\t\tdisp(['ERROR : --f-min ', flag_f_min(i, :), ' : port ', flag_f_min(i, 3), ' is not an active port.']);\n"
	         "\t\t\t\treturn;\n"
	         "\t\t\tendif\n"
	         "\t\telse\n"
	         "\t\t\tdisp(['ERROR : --f-min ', flag_f_min(i, :), ' : incorrect argument.']);\n"
	         "\t\t\treturn;\n"
	         "\t\tendif\n"
	         "\tendfor\n"
	         "endif\n"
	         "if exist('flag_f_equal_s', 'var')\n"
	         "\tfor i = 1:rows(flag_f_equal_s)\n"
	         "\t\tif numel(flag_f_equal_s(i, :)) == 3 && flag_f_equal_s(i, 1) == 's' ...\n"
	         "\t\t&& exist(['flag_active_port', flag_f_equal_s(i, 2)]) ...\n"
	         "\t\t&& exist(['flag_active_port', flag_f_equal_s(i, 3)])\n"
	         "\t\t\tif eval(['flag_active_port', flag_f_equal_s(i, 3)]) == false\n"
	         "\t\t\t\tdisp(['ERROR : --f-min ', flag_f_equal_s(i, :), ' : port ', flag_f_equal_s(i, 3), ' is not an active port.']);\n"
	         "\t\t\t\treturn;\n"
	         "\t\t\tendif\n"
	         "\t\telse\n"
	         "\t\t\tdisp(['ERROR : --f-min ', flag_f_equal_s(i, :), ' : incorrect argument.']);\n"
	         "\t\t\treturn;\n"
	         "\t\tendif\n"
	         "\tendfor\n"
	         "endif\n"
	         "\n"

	         "path_result = '" << name << "_result';\n"
	         "path_simulation = '" << name << "_simulation';\n"
	         "Sim_CSX = '" << name << ".csx';\n"
	         "\n"

	         "if flag_clean\n"
	         "\t[status, message, messageid] = rmdir(path_result, 's');\n"
	         "\t[status, message, messageid] = rmdir(path_simulation, 's');\n"
	         "\treturn;\n"
	         "endif\n"
	         "if flag_clean_result\n"
	         "\t[status, message, messageid] = rmdir(path_result, 's');\n"
	         "\treturn;\n"
	         "endif\n"
	         "if flag_clean_simulation\n"
	         "\t[status, message, messageid] = rmdir(path_simulation, 's');\n"
	         "\treturn;\n"
	         "endif\n"
	         "if flag_preprocess && flag_process && flag_postprocess\n"
	         "\t[status, message, messageid] = rmdir(path_result, 's');\n"
	         "\t[status, message, messageid] = rmdir(path_simulation, 's');\n"
	         "elseif flag_process\n"
	         "\t[status, message, messageid] = rmdir(path_simulation, 's');\n"
	         "endif\n"
	         "[status, message, messageid] = mkdir(path_result);\n"
	         "[status, message, messageid] = mkdir(path_simulation);\n"
	         "\n";

	f_out << "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% PREPROCESSING\n"
	         "\n";

	f_out << "%%%% VARIABLES\n"
	         "t_preprocess_start = clock();\n"
	         "physical_constants;\n";
	bool is_there_sp=false;
	for(shared_ptr<Element> it : block.elements) {
		if(it->getType()==".SP") {
			is_there_sp=true;
			f_out << "fstart = " << it->getFstart() << ";\n"
			         "fstop = " << it->getFstop() << ";\n"
			         "points = " << it->getN() << ";\n";
			}
		}
	if(!is_there_sp) {
		f_out << "fstart = ;\n"
		         "fstop = ;\n"
		         "points = ;\n";
		log_err << "WARNING : No active S parameter simulation in the schematic, you will have to set simulation frequencies manually.\n"; //TODO disp("set & rm this plz")
		}
	f_out << "f0 = (fstop + fstart) / 2; % Center frequency\n"
	         "fc = (fstop - fstart) / 2; % Cutoff frequency\n"
	         "unit = 1e-3;\n"
	         "lambda = c0 / (f0 + fc) / unit;\n"
	         "high_div = " << data.oems_highres_div << ";        % Depend on your simulation, you may want to tweak this value\n"
	         "metal_div = " << data.oems_metalres_div << ";        % Depend on your simulation, you may want to tweak this value\n"
	         "substrate_div = "<< data.oems_substres_div << ";    % Depend on your simulation, you may want to tweak this value\n"
	         "time_res = " << data.oems_timeres << ";     % Depend on your simulation, you may want to tweak this value\n"
	         "high_res = lambda / high_div;\n"
	         "metal_res = lambda / metal_div;\n"
	         "substrate_res = lambda / substrate_div;\n"
	         "\n";

	f_out << "%%%% SUBSTRATES\n"
	         "CSX = InitCSX();\n"
	         "if flag_preprocess\n"
	         "\n";

	for(shared_ptr<Element> it : block.elements) {
		type=it->getType();
		if(type=="SUBST") {
//			if(-it->getH()-it->getT()-it->getMargin()<extrem_pos_zmin) extrem_pos_zmin=-it->getH()-it->getT()-it->getMargin();
//			if(it->getT()+it->getMargin()>extrem_pos_zmax) extrem_pos_zmax=it->getT()+it->getMargin();
			if(-it->getH()-it->getT()<extrem_pos_zmin) extrem_pos_zmin=-it->getH()-it->getT();
			if(it->getT()>extrem_pos_zmax) extrem_pos_zmax=it->getT();
			f_out << "% " << it->getLabel() << " : " << type << "\n"
			         "endif % flag_preprocess\n" <<
			         it->getLabel() << ".metal.t = (" << it->getT() << ");\n" <<
			         it->getLabel() << ".metal.rho = (" << it->getRho() << ");\n" <<
			         it->getLabel() << ".metal.cond = (1 / " << it->getLabel() << ".metal.rho);\n" <<
			         it->getLabel() << ".center = [" << it->getX()+offset_x << ", " << -(it->getY()+offset_y) << ", " << it->getLabel() << ".metal.t];\n" <<
			         it->getLabel() << ".substrate.tand = (" << it->getTand() << ");\n" <<
			         it->getLabel() << ".substrate.Er = (" << it->getEr() << ");\n" <<
			         it->getLabel() << ".substrate.K = (" << it->getLabel() << ".substrate.tand * 2 * pi * f0 * EPS0 * " << it->getLabel() << ".substrate.Er);\n" <<
			         it->getLabel() << ".substrate.h = (" << it->getH() << ");\n" <<
			         it->getLabel() << ".substrate.L = (" << it->getL() << ");\n" <<
			         it->getLabel() << ".substrate.W = (" << it->getW() << ");\n" <<
			         it->getLabel() << ".dump.start = [" << it->getP(0, X, R, ABS)+offset_x << ", " << -(it->getP(0, Y, R, ABS)+offset_y) << ", (" << it->getLabel() << ".metal.t/2)];\n" <<
			         it->getLabel() << ".dump.stop = [" << it->getP(2, X, R, ABS)+offset_x << ", " << -(it->getP(2, Y, R, ABS)+offset_y) << ", (" << it->getLabel() << ".metal.t/2)];\n"
//			         it->getLabel() << ".cells = (" << "" << ");\n" << //TODO z mesh division
			         "if flag_preprocess\n"
			         "CSX = AddMaterial(CSX, '" << it->getLabel() << ".substrate');\n"
			         "CSX = SetMaterialProperty(CSX, '" << it->getLabel() << ".substrate', ...\n"
			         "\t'Epsilon', " << it->getLabel() << ".substrate.Er, ...\n"
			         "\t'Kappa', " << it->getLabel() << ".substrate.K);\n"
			         "CSX = AddBox(CSX, '" << it->getLabel() << ".substrate', 1, ...\n"
			         "\t[" << it->getP(0, X, R, ABS)+offset_x << ", " << -(it->getP(0, Y, R, ABS)+offset_y) << ", -" << it->getLabel() << ".substrate.h], ...\n"
			         "\t[" << it->getP(2, X, R, ABS)+offset_x << ", " << -(it->getP(2, Y, R, ABS)+offset_y) << ", 0]);\n"
//			         "CSX = AddMetal(CSX, '" << it->getLabel() << ".metal');\n"
//			         "%CSX = AddConductingSheet(CSX, '" << it->getLabel() << ".metal', " << it->getLabel() << ".metal.cond, " << it->getLabel() << ".metal.t*unit);\n" //TODO thickness? wtf & not well tested
//			         "if flag_smallbox == false\n"
			         "if flag_conductingsheet\n"
			         "CSX = AddConductingSheet(CSX, '" << it->getLabel() << ".ground', " << it->getLabel() << ".metal.cond, " << it->getLabel() << ".metal.t*unit);\n"
			         "CSX = AddBox(CSX, '" << it->getLabel() << ".ground', 2, ...\n"
			         "\t[" << it->getP(0, X, R, ABS)+offset_x << ", " << -(it->getP(0, Y, R, ABS)+offset_y) << ", -" << it->getLabel() << ".substrate.h], ...\n"
			         "\t[" << it->getP(2, X, R, ABS)+offset_x << ", " << -(it->getP(2, Y, R, ABS)+offset_y) << ", -" << it->getLabel() << ".substrate.h]);\n"
			         "else % flag_conductingsheet\n"
			         "CSX = AddMetal(CSX, '" << it->getLabel() << ".ground');\n"
			         "CSX = AddBox(CSX, '" << it->getLabel() << ".ground', 2, ...\n"
			         "\t[" << it->getP(0, X, R, ABS)+offset_x << ", " << -(it->getP(0, Y, R, ABS)+offset_y) << ", (-" << it->getLabel() << ".substrate.h - " << it->getLabel() << ".metal.t)], ...\n"
			         "\t[" << it->getP(2, X, R, ABS)+offset_x << ", " << -(it->getP(2, Y, R, ABS)+offset_y) << ", -" << it->getLabel() << ".substrate.h]);\n"
			         "endif % flag_conductingsheet\n"
//			         "endif % flag_smallbox == false\n"
			         "\n";
			}
		}

	f_out << "%%%% SHAPES\n";
	for(shared_ptr<Element> it : block.elements) {
		if(!it->getActive())
			continue;
		type=it->getType();
		if(type=="MGAP" || type=="MOPEN" || type=="MSTEP") {
			//nothing to do
		} else if(type=="MCORN"
		       || type=="MLIN") {
			f_out << "% " << it->getLabel() << " : " << type << "\n"
			         "endif % flag_preprocess\n" <<
			         it->getLabel() << ".center = [" << it->getX()+offset_x << ", " << -(it->getY()+offset_y) << ", " << it->getSubst() << ".metal.t];\n"
			         "if flag_preprocess\n"
			         "if flag_conductingsheet\n"
			         "CSX = AddConductingSheet(CSX, '" << it->getLabel() << "', " << it->getSubst() << ".metal.cond, " << it->getSubst() << ".metal.t*unit);\n"
			         "CSX = AddBox(CSX, '" << it->getLabel() << "', 2, ...\n"
//			         "CSX = AddBox(CSX, '" << it->getSubst() << ".metal', 1, ...\n"
			         "\t[" << it->getP(0, X, R, ABS)+offset_x << ", " << -(it->getP(0, Y, R, ABS)+offset_y) << ", 0], ...\n"
			         "\t[" << it->getP(2, X, R, ABS)+offset_x << ", " << -(it->getP(2, Y, R, ABS)+offset_y) << ", 0]);\n"
			         "else % flag_conductingsheet\n"
			         "CSX = AddMetal(CSX, '" << it->getLabel() << "');\n"
			         "CSX = AddBox(CSX, '" << it->getLabel() << "', 2, ...\n"
//			         "CSX = AddBox(CSX, '" << it->getSubst() << ".metal', 1, ...\n"
			         "\t[" << it->getP(0, X, R, ABS)+offset_x << ", " << -(it->getP(0, Y, R, ABS)+offset_y) << ", 0], ...\n"
			         "\t[" << it->getP(2, X, R, ABS)+offset_x << ", " << -(it->getP(2, Y, R, ABS)+offset_y) << ", " << it->getSubst() << ".metal.t]);\n"
			         "endif % flag_conductingsheet\n"
			         "\n";
		} else if(type=="MCOUPLED") {
			f_out << "% " << it->getLabel() << " : " << type << "\n"
			         "endif % flag_preprocess\n" <<
			         it->getLabel() << ".center = [" << it->getX()+offset_x << ", " << -(it->getY()+offset_y) << ", " << it->getSubst() << ".metal.t];\n"
			         "if flag_preprocess\n"
			         "CSX = AddMetal(CSX, '" << it->getLabel() << "');\n"
			         "CSX = AddBox(CSX, '" << it->getLabel() << "', 2, ...\n"
//			         "CSX = AddBox(CSX, '" << it->getSubst() << ".metal', 1, ...\n"
			         "\t[" << it->getP(0, X, R, ABS)+offset_x << ", " << -(it->getP(0, Y, R, ABS)+offset_y) << ", 0], ...\n"
			         "\t[" << it->getP(2, X, R, ABS)+offset_x << ", " << -(it->getP(2, Y, R, ABS)+offset_y) << ", " << it->getSubst() << ".metal.t]);\n"
			         "CSX = AddBox(CSX, '" << it->getLabel() << "', 2, ...\n"
//			         "CSX = AddBox(CSX, '" << it->getSubst() << ".metal', 1, ...\n"
			         "\t[" << it->getP(4, X, R, ABS)+offset_x << ", " << -(it->getP(4, Y, R, ABS)+offset_y) << ", 0], ...\n"
			         "\t[" << it->getP(6, X, R, ABS)+offset_x << ", " << -(it->getP(6, Y, R, ABS)+offset_y) << ", " << it->getSubst() << ".metal.t]);\n"
			         "\n";
		} else if(type=="MCROSS"
		       || type=="MMBEND"
		       || type=="MRSTUB"
		       || type=="MTEE") {
			f_out << "% " << it->getLabel() << " : " << type << "\n"
			         "endif % flag_preprocess\n" <<
			         it->getLabel() << ".center = [" << it->getX()+offset_x << ", " << -(it->getY()+offset_y) << ", " << it->getSubst() << ".metal.t];\n"
			         "if flag_preprocess\n"
			         "p = zeros(2, " << it->getNpoint() << ");\n";
			for(int i=0;i<it->getNpoint();i++) {
				f_out << "p(1, " << i+1 << ") = " << it->getP(i, X, R, ABS)+offset_x << "; p(2, " << i+1 << ") = " << -(it->getP(i, Y, R, ABS)+offset_y) << ";\n";
				}
			f_out << "CSX = AddMetal(CSX, '" << it->getLabel() << "');\n"
			         "CSX = AddLinPoly(CSX, '" << it->getLabel() << "', 2, 2, 0, p, " << it->getSubst() << ".metal.t);\n"
//			f_out << "CSX = AddLinPoly(CSX, '" << it->getSubst() << ".metal', 1, 2, 0, p, " << it->getSubst() << ".metal.t);\n"
			         "\n";
		} else if(type=="MVIA") {
			f_out << "% " << it->getLabel() << " : " << type << "\n"
			         "endif % flag_preprocess\n" <<
			         it->getLabel() << ".center = [" << it->getX()+offset_x << ", " << -(it->getY()+offset_y) << ", " << it->getSubst() << ".metal.t];\n"
			         "if flag_preprocess\n"
			         "CSX = AddMetal(CSX, '" << it->getLabel() << "');\n"
			         "CSX = AddBox(CSX, '" << it->getLabel() << "', 2, ...\n"
//			         "CSX = AddBox(CSX, '" << it->getSubst() << ".metal', 1, ...\n"
			         "\t[" << it->getX()+it->getD()/2+offset_x << ", " << -(it->getY()+it->getD()/2+offset_y) << ", (-" << it->getSubst() << ".substrate.h - " << it->getSubst() << ".metal.t)], ...\n"
			         "\t[" << it->getX()-it->getD()/2+offset_x << ", " << -(it->getY()-it->getD()/2+offset_y) << ", " << it->getSubst() << ".metal.t]);\n"
			         "\n";
			}
		}

	f_out << "%%%% MESH\n"
	         "endif % flag_preprocess\n"
	         "mesh.x = [];\n"
	         "mesh.y = [];\n"
	         "mesh.z = [];\n"
	         "if flag_preprocess\n"
	         "if flag_mesh\n"
	         "\n";

	f_out << "% High resolution mesh for non orthogonal shapes\n"
	         "if flag_highresmesh\n"
	         "mesh.x = [mesh.x, ...\n";
	for(auto line=begin(mesh.x);line<end(mesh.x);++line) {
		if(line->high_res && next(line)!=end(mesh.x) && next(line)->high_res && line->label==next(line)->label) {
			f_out << "\t(linspace(";
			for(unsigned int i=0;i<2;i++) {
				advance(line, i);
				if(line->third_rule) {
					switch(line->direction) {
						case XMIN: f_out << "(" << line->position << " - 2*high_res/3), "; break;
						case XMAX: f_out << "(" << line->position << " + 2*high_res/3), "; break;
						}
				} else {
					f_out << "(" << line->position << "), ";
					}
				}
			advance(line, -1);
			f_out << "(abs(";
			for(unsigned int i=0;i<2;i++) {
				advance(line, i);
				if(line->third_rule) {
					switch(line->direction) {
						case XMIN: f_out << "(" << line->position << " - 2*high_res/3)"; break;
						case XMAX: f_out << "(" << line->position << " + 2*high_res/3)"; break;
						}
				} else {
					f_out << "(" << line->position << ")";
					}
				if(i==0) {
					f_out << " - ";
					}
				}
			f_out << ") / high_res))), ... % " << line->label << " : " << line->type << "\n";
			}
		}
	f_out << "\t];\n";

	f_out << "mesh.y = [mesh.y, ...\n";
	for(auto line=begin(mesh.y);line<end(mesh.y);++line) {
		if(line->high_res && next(line)!=end(mesh.y) && next(line)->high_res && line->label==next(line)->label) {
			f_out << "\t(linspace(";
			for(unsigned int i=0;i<2;i++) {
				advance(line, i);
				if(line->third_rule) {
					switch(line->direction) {
						case YMIN: f_out << "(" << -line->position << " + 2*high_res/3), "; break;
						case YMAX: f_out << "(" << -line->position << " - 2*high_res/3), "; break;
						}
				} else {
					f_out << "(" << -line->position << "), ";
					}
				}
			advance(line, -1);
			f_out << "(abs(";
			for(unsigned int i=0;i<2;i++) {
				advance(line, i);
				if(line->third_rule) {
					switch(line->direction) {
						case YMIN: f_out << "(" << -line->position << " + 2*high_res/3)"; break;
						case YMAX: f_out << "(" << -line->position << " - 2*high_res/3)"; break;
						}
				} else {
					f_out << "(" << line->position << ")";
					}
				if(i==0) {
					f_out << " - ";
					}
				}
			f_out << ") / high_res))), ... % " << line->label << " : " << line->type << "\n";
			}
		}
	f_out << "\t];\n"
	         "endif % flag_highresmesh\n"
	         "\n";

	f_out << "% Standard metal resolution mesh for orthogonal shapes\n"
	         "if flag_metalresmesh\n"
	         "mesh.x = [mesh.x, ...\n";
	for(auto line=begin(mesh.x);line<end(mesh.x);++line) {
		if(line->high_res && next(line)!=end(mesh.x) && next(line)->high_res && line->label==next(line)->label) {
			advance(line, 1); // Skip the pair
		} else {
			if(line->third_rule) {
				switch(line->direction) {
					case XMIN: f_out << "\t(" << line->position << " - 2*metal_res/3), (" << line->position << " + metal_res/3), ... % " << line->label << " : " << line->type << "\n"; break;
					case XMAX: f_out << "\t(" << line->position << " + 2*metal_res/3), (" << line->position << " - metal_res/3), ... % " << line->label << " : " << line->type << "\n"; break;
					}
			} else {
				f_out << "\t(" << line->position << "), ... % " << line->label << " : " << line->type << "\n";
				}
			}
		}
	f_out << "\t];\n";

	f_out << "mesh.y = [mesh.y, ...\n";
	for(auto line=begin(mesh.y);line<end(mesh.y);++line) {
		if(line->high_res && next(line)!=end(mesh.y) && next(line)->high_res && line->label==next(line)->label) {
			advance(line, 1); // Skip the pair
		} else {
			if(line->third_rule) {
				switch(line->direction) {
					case YMIN: f_out << "\t(" << -line->position << " + 2*metal_res/3), (" << -line->position << " - metal_res/3), ... % " << line->label << " : " << line->type << "\n"; break;
					case YMAX: f_out << "\t(" << -line->position << " - 2*metal_res/3), (" << -line->position << " + metal_res/3), ... % " << line->label << " : " << line->type << "\n"; break;
					}
			} else {
				f_out << "\t(" << -line->position << ") ... % " << line->label << " : " << line->type << "\n";
				}
			}
		}
	f_out << "\t];\n";

	f_out << "mesh.z = [mesh.z, ...\n";
	for(shared_ptr<Element> it : block.elements) {
		if(it->getType()=="SUBST") {
			f_out << "\t(-" << it->getLabel() << ".substrate.h/3), ...\n"
			         "\t(-2*" << it->getLabel() << ".substrate.h/3), ...\n";
			}
		}
	f_out << "\t];\n"
	         "if flag_conductingsheet\n"
	         "mesh.z = [mesh.z, ...\n";
	for(shared_ptr<Element> it : block.elements) {
		if(it->getType()=="SUBST") {
			f_out << "\t(0), ...\n"
			         "\t(-" << it->getLabel() << ".substrate.h), ...\n";
			}
		}
	f_out << "\t];\n"
	         "else % flag_conductingsheet\n"
	         "mesh.z = [mesh.z, ...\n";
	for(shared_ptr<Element> it : block.elements) {
		if(it->getType()=="SUBST") {
			f_out << "\t(" << it->getLabel() << ".metal.t/2), ...\n"
			         "\t(-" << it->getLabel() << ".substrate.h - " << it->getLabel() << ".metal.t/2), ...\n";
			}
		}
	f_out << "\t];\n"
	         "endif % flag_conductingsheet\n"
             "max_recursion_depth(1024);\n";

//	f_out << "mesh.z = linspace(" << -substrate.h-copper.h << ", "copper.h", 4);\n";

	f_out << "if flag_smoothmesh\n"
	         "mesh = SmoothMesh(mesh, metal_res,\"algorithm\",\"RecursiveSmoothMesh\");\n"
	         "endif % flag_smoothmesh\n"
	         "endif % flag_metalresmesh\n"
	         "endif % flag_mesh\n"
	         "endif % flag_preprocess\n"
	         "\n"
//	         "mesh.x = [mesh.x, -SimBox(1)/2, SimBox(1)/2];\n"
//	         "mesh.y = [mesh.y, -SimBox(2)/2, SimBox(2)/2];\n"
//	         "mesh.x = [mesh.x, 0, SimBox(1)];\n"
//	         "mesh.y = [mesh.y, 0, SimBox(2)];\n"
//	         "mesh.z = [mesh.z, -SimBox(3)/2, SimBox(3)/2];\n"
	         "% Boundary box\n"
	         "if flag_mesh\n"
//	         "mesh.x = [mesh.x, " << block.boundary[XMIN]+offset_x << ", " << block.boundary[XMAX]+offset_x << "];\n"
//	         "mesh.y = [mesh.y, " << -(block.boundary[YMIN]+offset_y) << ", " << -(block.boundary[YMAX]+offset_y) << "];\n" //TODO
//	         "mesh.z = [mesh.z, " << extrem_pos_zmin << ", " << extrem_pos_zmax << "];\n"

	 //TODO WTF, no extrem_pos?
//	         "mesh.x = [mesh.x, (" << block.extrem_pos[XMIN]+offset_x << "), (" << block.extrem_pos[XMAX]+offset_x << ")];\n"
//	         "mesh.y = [mesh.y, (" << -(block.extrem_pos[YMIN]+offset_y) << "), (" << -(block.extrem_pos[YMAX]+offset_y) << ")];\n"
//	         "mesh.z = [mesh.z, (" << extrem_pos_zmin << "), (" << extrem_pos_zmax << ")];\n"

	         "mesh.x = [mesh.x, " << block.boundary[XMIN]+offset_x << " - lambda * " << data.oems_boundary_factor << "/4, " << block.boundary[XMAX]+offset_x << " + lambda * " << data.oems_boundary_factor << "/4];\n"
	         "mesh.y = [mesh.y, " << -(block.boundary[YMIN]+offset_y) << " + lambda * " << data.oems_boundary_factor << "/4, " << -(block.boundary[YMAX]+offset_y) << " - lambda * " << data.oems_boundary_factor << "/4];\n" //TODO
	         "mesh.z = [mesh.z, " << extrem_pos_zmin << " - lambda * " << data.oems_boundary_factor << "/4, " << extrem_pos_zmax << " + lambda * " << data.oems_boundary_factor << "/4];\n"


	         "if flag_smoothmesh\n"
	         "mesh = SmoothMesh(mesh, substrate_res,\"algorithm\",\"RecursiveSmoothMesh\");\n"
	         "endif % flag_smoothmesh\n"
	         "endif % flag_mesh\n"
	         "\n"
	         "if flag_preprocess\n"
	         "CSX = DefineRectGrid(CSX, unit, mesh);\n"
	         "endif % flag_preprocess\n"
	         "\n";

	f_out << "%%%% PORTS\n";
	for(pair<unsigned int, shared_ptr<Element>> it : ports) {
		f_out << "% " << it.second->getLabel() << " : " << it.second->getType() << "\n" <<
		         it.second->getLabel() << ".center = [" << it.second->getX()+offset_x << ", " << -(it.second->getY()+offset_y) << ", " << it.second->getSubst() << ".metal.t];\n" <<
		         it.second->getLabel() << ".Z = (" << it.second->getZ() << ");\n" <<
		         it.second->getLabel() << ".P = (" << it.second->getDbm() << ");\n" <<
		         it.second->getLabel() << ".F = (" << it.second->getF() << ");\n" <<
		         "if flag_conductingsheet\n"
		         "[CSX port{" << it.second->getN() << "}] = AddLumpedPort(CSX, 5, " << it.second->getN() << ", " << it.second->getLabel() << ".Z, ...\n"
		         "\t[" << it.second->getP(0, X, R, ABS)+offset_x << ", " << -(it.second->getP(0, Y, R, ABS)+offset_y) << ", (-" << it.second->getSubst() << ".substrate.h)" << "], ...\n"
		         "\t[" << it.second->getP(2, X, R, ABS)+offset_x << ", " << -(it.second->getP(2, Y, R, ABS)+offset_y) << ", (0)" << "], ...\n"
		         "\t[0 0 1], flag_active_port" << it.first << ");\n"
		         "else % flag_conductingsheet\n"
		         "[CSX port{" << it.second->getN() << "}] = AddLumpedPort(CSX, 5, " << it.second->getN() << ", " << it.second->getLabel() << ".Z, ...\n"
		         "\t[" << it.second->getP(0, X, R, ABS)+offset_x << ", " << -(it.second->getP(0, Y, R, ABS)+offset_y) << ", (-" << it.second->getSubst() << ".substrate.h - " << it.second->getSubst() << ".metal.t)" << "], ...\n"
		         "\t[" << it.second->getP(2, X, R, ABS)+offset_x << ", " << -(it.second->getP(2, Y, R, ABS)+offset_y) << ", (" << it.second->getSubst() << ".metal.t)" << "], ...\n"
		         "\t[0 0 1], flag_active_port" << it.first << ");\n"
		         "endif % flag_conductingsheet\n"
		         "\n";
		}

	f_out << "%%%% SIMULATION\n"
	         "if flag_preprocess\n"
	         "FDTD = InitFDTD('EndCriteria', 1e-3);\n"
	         "FDTD = SetGaussExcite(FDTD, f0, fc);\n"
	         "if flag_mur\n"
	         "\tBC = {'MUR', 'MUR', 'MUR', 'MUR', 'MUR', 'MUR'};\n"
	         "else\n"
	         "\tBC = {'PML_8', 'PML_8', 'PML_8', 'PML_8', 'PML_8', 'PML_8'};\n"
	         "endif\n"
	         "FDTD = SetBoundaryCond(FDTD, BC);\n"
	         "endif % flag_preprocess\n"
	         "\n";

	f_out << "%%%% NF2FF\n"
	         "if flag_nf2ff\n"
	         "if flag_mesh\n"
	         "if flag_smoothmesh\n"
	         "% Be careful that NF2FF box boundaries are not in PML\n"
	         "[CSX nf2ff] = CreateNF2FFBox(CSX, 'nf2ff', ...\n"
	         "\t[mesh.x(10), mesh.y(10), mesh.z(10)], ...\n"
	         "\t[mesh.x(end-9), mesh.y(end-9), mesh.z(end-9)]);\n"
	         "endif % flag_smoothmesh\n"
	         "endif % flag_mesh\n"
	         "endif % flag_nf2ff\n"
	         "\n";

	f_out << "%%%% DUMPS\n"
	         "if flag_preprocess\n"
	         "if flag_dump\n";
	for(shared_ptr<Element> it : block.elements) {
		if(it->getType()=="SUBST") {
			f_out << "% " << it->getLabel() << " ET\n"
			         "CSX = AddDump(CSX, '" << it->getLabel() << ".Et', 'DumpType', 0);\n"
			         "CSX = AddBox(CSX, '" << it->getLabel() << ".Et', 0, " << it->getLabel() << ".dump.start, " << it->getLabel() << ".dump.stop);\n"
			         "% " << it->getLabel() << " HT\n"
			         "CSX = AddDump(CSX, '" << it->getLabel() << ".Ht', 'DumpType', 1);\n"
			         "CSX = AddBox(CSX, '" << it->getLabel() << ".Ht', 0, " << it->getLabel() << ".dump.start, " << it->getLabel() << ".dump.stop);\n"
			         "% " << it->getLabel() << " CURRENT\n"
			         "CSX = AddDump(CSX, '" << it->getLabel() << ".Jt', 'DumpType', 2, 'DumpMode', 0);\n"
			         "CSX = AddBox(CSX, '" << it->getLabel() << ".Jt', 0, " << it->getLabel() << ".dump.start, " << it->getLabel() << ".dump.stop);\n"
			         "% " << it->getLabel() << " CURRENT DENSITY\n"
			         "CSX = AddDump(CSX, '" << it->getLabel() << ".Cdt', 'DumpType', 3);\n"
			         "CSX = AddBox(CSX, '" << it->getLabel() << ".Cdt', 0, " << it->getLabel() << ".dump.start, " << it->getLabel() << ".dump.stop);\n"
			         "\n";
			}
		}
	f_out << "endif % flag_dump\n"
	         "\n";

	f_out << "%%%% RUN OPENEMS\n"
	         "WriteOpenEMS([path_simulation '/' Sim_CSX], FDTD, CSX);\n"
	         "t_preprocess_stop = clock();\n"
	         "endif % flag_preprocess\n"
	         "if flag_gui\n"
	         "CSXGeomPlot([path_simulation '/' Sim_CSX]);\n"
	         "endif % flag_gui\n"
	         "if flag_process\n"
	         "t_process_start = clock();\n"
	         "Settings.SSH.host = 'openems-home';\n"
             "Settings.SSH.bin = '/home/dom/opt/openEMS/bin/openEMS.sh';\n"
             "RunOpenEMS(path_simulation,Sim_CSX,'',Settings)\n"
 	         "t_process_stop = clock();\n"
	         "endif % flag_process\n"
	         "\n";

	f_out << "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FUNCTIONS\n"
	         "\n";

	f_out << "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n"
	         "function h = plotFF3D_frames(nf2ff, prefix, varargin)\n"
	         "% h = plotFF3D_frames(nf2ff, varargin)\n"
	         "%\n"
	         "% This is an enhanced version of plotFF3D to plot 3D far field pattern for\n"
	         "% multiple frequencies. It will plot a frame for each frequency present in\n"
	         "% nf2ff. It can also produce an animated gif.\n"
	         "% For now, supports only V/m output.\n"
	         "%\n"
	         "% input:\n"
	         "%   nf2ff:                 - Output of CalcNF2FF\n"
	         "%   prefix:                - Frame name: '<prefix>@<f>.<format>'.\n"
	         "%                          - Gif name: '<prefix>.<format>'.\n"
	         "%\n"
	         "% variable input:\n"
	         "%   'unique_color_scale':  - Use an unique color scale for all frames.\n"
	         "%   'unique_axis_scale':   - Use an unique axis scale for all frames.\n"
	         "%   'unique_xyz_scale':    - Use an unique scale for x, y, z axis on each frame.\n"
	         "%   'gif' <bool>:          - Merge all frames in an animated gif.\n"
	         "%                          - Use ImageMagick's 'convert' command.\n"
	         "%                          - Default: false.\n"
	         "%   'delay' <str>:         - Delay between frames in the gif.\n"
	         "%                          - Cf. convert '-delay' argument.\n"
	         "%                          - Default: '30'.\n"
	         "%   'colormap' <str>:      - Set a colormap for the plots.\n"
	         "%                          - Default: 'jet'.\n"
	         "%   'show_each' <bool>:    - Show each frame in its figure window.\n"
	         "%                          - Default: false.\n"
	         "%   'print' <bool>:        - Do not save frames/gif on disk.\n"
	         "%                          - Default: true.\n"
	         "%   'format' <str>:        - Frame format.\n"
	         "%                          - You probably must not override it.\n"
	         "%                          - Default: 'png'.\n"
	         "%\n"
	         "% example:\n"
	         "%   plotFF3D_frames(nf2ff, [name, '-ff3d-vm'], 'gif', true, ...\n"
	         "%       'unique_color_scale', 'unique_axis_scale');\n"
	         "%\n"
	         "% See also plotFF3D\n"
	         "%\n"
	         "% openEMS matlab interface\n"
	         "% -----------------------\n"
	         "% author: Thomas Lepoix\n"
	         "\n"
	         "flag_vm = true;\n"
	         "\n"
	         "unique_color_scale = false;\n"
	         "unique_axis_scale = false;\n"
	         "unique_xyz_scale = false;\n"
	         "gif = false;\n"
	         "delay = '30';\n"
	         "colormap_arg = 'jet';\n"
	         "show_each = false;\n"
	         "print_arg = true;\n"
	         "format_arg = 'png';\n"
	         "\n"
	         "n = 1;\n"
	         "while n <= numel(varargin)\n"
	         "\tif (strcmp(varargin{n}, 'unique_color_scale') == 1);\n"
	         "\t\tunique_color_scale = true;\n"
	         "\telseif (strcmp(varargin{n}, 'unique_axis_scale') == 1);\n"
	         "\t\tunique_axis_scale = true;\n"
	         "\telseif (strcmp(varargin{n}, 'unique_xyz_scale') == 1);\n"
	         "\t\tunique_xyz_scale = true;\n"
	         "\telseif (strcmp(varargin{n}, 'gif') == 1);\n"
	         "\t\tgif = varargin{n + 1};\n"
	         "\t\tn = n + 1;\n"
	         "\telseif (strcmp(varargin{n}, 'delay') == 1);\n"
	         "\t\tdelay = varargin{n+1};\n"
	         "\t\tn = n + 1;\n"
	         "\telseif (strcmp(varargin{n}, 'colormap') == 1);\n"
	         "\t\tcolormap_arg = varargin{n+1};\n"
	         "\t\tn = n + 1;\n"
	         "\telseif (strcmp(varargin{n}, 'show_each') == 1);\n"
	         "\t\tshow_each = varargin{n + 1};\n"
	         "\t\tn = n + 1;\n"
	         "\telseif (strcmp(varargin{n}, 'print') == 1);\n"
	         "\t\tprint_arg = varargin{n + 1};\n"
	         "\t\tn = n + 1;\n"
	         "\telseif (strcmp(varargin{n}, 'format') == 1);\n"
	         "\t\tformat_arg = varargin{n+1};\n"
	         "\t\tn = n + 1;\n"
	         "\telse\n"
	         "\t\twarning('openEMS:plotFF3D_frames', ['unknown argument key: ''' varargin{n} '''']);\n"
	         "\tendif\n"
	         "\tn = n + 1;\n"
	         "endwhile\n"
	         "\n"
	         "for n = 1:numel(nf2ff.freq)\n"
	         "\tif flag_vm\n"
	         "\t\tE_far{n} = nf2ff.E_norm{n};\n"
	         "\tendif\n"
	         "\n"
	         "\t[theta, phi] = ndgrid(nf2ff.theta, nf2ff.phi);\n"
	         "\tx{n} = E_far{n} .* sin(theta) .* cos(phi);\n"
	         "\ty{n} = E_far{n} .* sin(theta) .* sin(phi);\n"
	         "\tz{n} = E_far{n} .* cos(theta);\n"
	         "\n"
	         "\tif n == 1\n"
	         "\t\tE_far_min = min(E_far{n}(:));\n"
	         "\t\tE_far_max = max(E_far{n}(:));\n"
	         "\t\tE_far_max_x = max(abs(x{n}(:)));\n"
	         "\t\tE_far_max_y = max(abs(y{n}(:)));\n"
	         "\t\tE_far_max_z = max(abs(z{n}(:)));\n"
	         "\telse\n"
	         "\t\tif min(E_far{n}(:)) < E_far_min\n"
	         "\t\t\tE_far_min = min(E_far{n}(:));\n"
	         "\t\tendif\n"
	         "\t\tif max(E_far{n}(:)) > E_far_max\n"
	         "\t\t\tE_far_max = max(E_far{n}(:));\n"
	         "\t\tendif\n"
	         "\t\tif max(abs(x{n}(:))) > E_far_max_x\n"
	         "\t\t\tE_far_max_x = max(abs(x{n}(:)));\n"
	         "\t\tendif\n"
	         "\t\tif max(abs(y{n}(:))) > E_far_max_y\n"
	         "\t\t\tE_far_max_y = max(abs(y{n}(:)));\n"
	         "\t\tendif\n"
	         "\t\tif max(abs(z{n}(:))) > E_far_max_z\n"
	         "\t\t\tE_far_max_z = max(abs(z{n}(:)));\n"
	         "\t\tendif\n"
	         "\tendif\n"
	         "\n"
	         "\tfstop_digit_number = numel(num2str(nf2ff.freq(n)));\n"
	         "endfor\n"
	         "\n"
	         "if show_each == false\n"
	         "\tfigure;\n"
	         "endif\n"
	         "for n = 1:numel(nf2ff.freq)\n"
	         "\tif show_each\n"
	         "\t\tfigure;\n"
	         "\tendif\n"
	         "\tcolormap(colormap_arg);\n"
	         "\n"
	         "\th = surf(x{n}, y{n}, z{n}, E_far{n});\n"
	         "\tset(h, 'EdgeColor', 'none');\n"
	         "\taxis equal;\n"
	         "\taxis off;\n"
	         "\n"
	         "\tif flag_vm\n"
	         "\t\ttitletext = sprintf('Electrical far field [V/m] @ f = %e Hz', nf2ff.freq(n));\n"
	         "\tendif\n"
	         "\ttitle(titletext);\n"
	         "\n"
	         "\tif unique_color_scale\n"
	         "\t\tcb = colorbar('YTick', linspace(E_far_min, E_far_max, 9));\n"
	         "\t\tcaxis([0, E_far_max]);\n"
	         "\telse\n"
	         "\t\tcb = colorbar('YTick', linspace(min(E_far{n}(:)), max(E_far{n}(:)), 9));\n"
	         "\tendif\n"
	         "\tset(cb, 'Position', [0.75, 0.2, 0.05, 0.6]);\n"
	         "\n"
	         "\tif unique_axis_scale && unique_xyz_scale\n"
	         "\t\txlim([-E_far_max, E_far_max]);\n"
	         "\t\tylim([-E_far_max, E_far_max]);\n"
	         "\t\tzlim([-E_far_max, E_far_max]);\n"
	         "\telseif unique_axis_scale\n"
	         "\t\txlim([-E_far_max_x, E_far_max_x]);\n"
	         "\t\tylim([-E_far_max_y, E_far_max_y]);\n"
	         "\t\tzlim([-E_far_max_z, E_far_max_z]);\n"
	         "\telseif unique_xyz_scale\n"
	         "\t\tlimit = max([xlim, ylim, zlim]);\n"
	         "\t\txlim([-limit, limit]);\n"
	         "\t\tylim([-limit, limit]);\n"
	         "\t\tzlim([-limit, limit]);\n"
	         "\tendif\n"
	         "\n"
	         "\tdrawnow;\n"
	         "\tif print_arg\n"
	         "\t\tprint([prefix, '@', ...\n"
	         "\t\t\tnum2str(nf2ff.freq(n), ['%0', num2str(fstop_digit_number), '.0f']), ...\n"
	         "\t\t\t'.', format_arg]);\n"
	         "\tendif\n"
	         "endfor\n"
	         "\n"
	         "if print_arg && gif\n"
	         "\tsystem(['convert -delay ', delay, ' -loop 0 ', ...\n"
	         "\t\tprefix, '@*.', format_arg, ' ', ...\n"
	         "\t\tprefix, '.gif']);\n"
	         "endif\n"
	         "\n"
	         "end\n"
	         "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n"
	         "\n";

	f_out << "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n"
	         "function h = plotSmith(s, name, freq, f_ind, varargin)\n"
	         "% h = plotSmith(s, name, freq, f_ind, varargin)\n"
	         "%\n"
	         "% Reworked version of plotRefl to plot other S parameters than s11 and to plot\n"
	         "% multiple S parameters on the same graphic.\n"
	         "%\n"
	         "% input:\n"
	         "%   s:         S parameter.\n"
	         "%   name:      S parameter name to display.\n"
	         "%   freq:      Frequency array.\n"
	         "%   f_ind:     Index array in 'freq' of the frequencies to put a marker on.\n"
	         "%\n"
	         "% variable input:\n"
	         "%   'precision':   - Number of decimal places (floating point precision)\n"
	         "%                    for the frequency (always in MHz), default is 2\n"
	         "%   'nogrid':      - Do not replot grid.\n"
	         "%                  - Not to put older plots under the grid, you should use it\n"
	         "%                    unless it is the first time you use plotSmith in a figure.\n"
	         "%\n"
	         "% example:\n"
	         "%   freq = [linspace(fstart, fstop, points), f_res];\n"
	         "%   sort(freq);\n"
	         "%   port{1} = calcPort(port{1}, Sim_Path, freq);\n"
	         "%   port{2} = calcPort(port{2}, Sim_Path, freq);\n"
	         "%   s11 = port{1}.uf.ref ./ port{1}.uf.inc;\n"
	         "%   s21 = port{2}.uf.ref ./ port{1}.uf.inc;\n"
	         "%   f_res_ind = find(freq == f_res);\n"
	         "%   figure;\n"
	         "%   plotSmith(s11, 's11', freq, f_res_ind);\n"
	         "%   plotSmith(s21, 's21', freq, f_res_ind, 'nogrid');\n"
	         "%   drawnow;\n"
	         "%\n"
	         "% See also PlotRefl\n"
	         "%\n"
	         "% openEMS matlab interface\n"
	         "% -----------------------\n"
	         "% author: Thomas Lepoix\n"
	         "\n"
	         "precision = 2;\n"
	         "grid_arg = true;\n"
	         "\n"
	         "for n=1:2:numel(varargin)\n"
	         "\tif (strcmp(varargin{n},'precision')==1);\n"
	         "\t\tprecision = varargin{n+1};\n"
	         "\telseif (strcmp(varargin{n},'nogrid')==1);\n"
	         "\t\tgrid_arg = false;\n"
	         "\telse\n"
	         "\t\twarning('openEMS:plotSmith', ['unknown argument key: ''' varargin{n} '''']);\n"
	         "\tendif\n"
	         "endfor\n"
	         "\n"
	         "ffmt = ['%.', num2str(precision), 'f'];\n"
	         "\n"
	         "if grid_arg\n"
	         "\taxis ([-1.15, 1.15, -1.15, 1.15], 'square');\n"
	         "\taxis off;\n"
	         "\thold on;\n"
	         "\n"
	         "\t% Horizontal axis\n"
	         "\tplot([-1, 1], [0, 0], 'color', [0.9, 0.9, 0.9]);\n"
	         "\n"
	         "\t% Inner curved lines\n"
	         "\tReZ = [0.2; 0.5; 1; 2];\n"
	         "\tImZ = 1i * [1, 2, 5, 2];\n"
	         "\tZ = ReZ .+ linspace(-ImZ, ImZ, 256);\n"
	         "\tGamma = (Z-1)./(Z+1);\n"
	         "\tplot(Gamma.', 'color', [0.9, 0.9, 0.9]);\n"
	         "\n"
	         "\tReZ = [0.5, 0.5, 1, 1, 2, 2, 5, 5, 10, 10];\n"
	         "\tImZ = 1i * [-0.2; 0.2; -0.5; 0.5; -1; 1; -2; 2; -5; 5];\n"
	         "\tZ = linspace(0, ReZ, 256) .+ ImZ;\n"
	         "\tGamma = (Z-1)./(Z+1);\n"
	         "\tplot(Gamma.', 'color', [0.9, 0.9, 0.9]);\n"
	         "\n"
	         "\t% Inner circles\n"
	         "\tangle = linspace (0, 2 * pi, 256);\n"
	         "\tReZ = [5, 10];\n"
	         "\tcenter = ReZ ./ (ReZ + 1);\n"
	         "\tradius = 1 ./ (ReZ + 1);\n"
	         "\tplot(radius .* cos(angle.') .+ center, radius .* sin(angle.'), 'color', [0.9, 0.9, 0.9]);\n"
	         "\n"
	         "\t% Outer black circle\n"
	         "\tReZ = [0];\n"
	         "\tcenter = ReZ ./ (ReZ + 1);\n"
	         "\tradius = 1 ./ (ReZ + 1);\n"
	         "\tplot(radius .* cos(angle.') .+ center, radius .* sin(angle.'), 'k');\n"
	         "\n"
	         "\t% A trick to restore color order\n"
	         "\tplot(0, 'visible', 'off');\n"
	         "\n"
	         "\t% Resistance\n"
	         "\tReZ = [0.2, 0.5, 1, 2, 5, 10];\n"
	         "\tImZ = zeros(1, length (ReZ));\n"
	         "\trho = (ReZ.^2 + ImZ.^2 - 1 + 2i * ImZ) ./ ((ReZ + 1).^2 + ImZ.^2);\n"
	         "\n"
	         "\txoffset = [0.1, 0.1, 0.05, 0.05, 0.05, 0.075]; \n"
	         "\tyoffset = -0.03;\n"
	         "\n"
	         "\tfor idx = 1:length(ReZ)\n"
	         "\t\ttext(real(rho(idx)) - xoffset(idx), ...\n"
	         "\t\t\timag(rho(idx)) - yoffset, ...\n"
	         "\t\t\tnum2str(ReZ(idx)));\n"
	         "\tendfor\n"
	         "\n"
	         "\t% Reactance\n"
	         "\tReZ = [-0.06, -0.06, -0.06, -0.12, -0.5];\n"
	         "\tImZ = [0.2, 0.5, 1, 2, 5];\n"
	         "\trho = (ReZ.^2 + ImZ.^2 - 1 + 2i * ImZ) ./ ((ReZ + 1).^2 + ImZ.^2);\n"
	         "\n"
	         "\tfor idx = 1:length(ImZ)\n"
	         "\t\ttext(real(rho(idx)), imag(rho(idx)), [num2str(ImZ(idx)), 'j']);\n"
	         "\t\ttext(real(rho(idx)), -imag(rho(idx)), [num2str(-ImZ(idx)), 'j']);\n"
	         "\tendfor\n"
	         "\n"
	         "\t% Zero\n"
	         "\trho = (-0.05.^2 + 0.^2 - 1) ./ ((-0.05 + 1).^2 + 0.^2);\n"
	         "\ttext(real(rho), imag(rho), '0');\n"
	         "endif\n"
	         "\n"
	         "% Markers\n"
	         "for i = 1:numel(f_ind)\n"
	         "\tz = s(f_ind(i));\n"
	         "\tif imag(z) >= 0\n"
	         "\t\tz_str = '+';\n"
	         "\telse\n"
	         "\t\tz_str = '';\n"
	         "\tendif\n"
	         "\tz_str = [num2str(real(z), '%.2f'), z_str, num2str(imag(z), '%.2f'), 'j'];\n"
	         "\th = plot(s(f_ind(i)), ['o;', ...\n"
	         "\t\tname, ' @ ', num2str(freq(f_ind(i))/1e6, ffmt), ' MHz', ...\n"
	         "\t\t\"\\n\", num2str(20*log10(abs(s(f_ind(i)))), '%.1f'), 'dB ', ...\n"
	         "%\t\tnum2str(s(f_ind(i)), '%.2f'), ' Ω', ...\n"
	         "\t\tz_str, ...\n"
	         "\t\t';'], 'linewidth', 2);\n"
	         "\tset(gca, 'ColorOrder', circshift(get(gca, 'ColorOrder'), numel(h)));\n"
	         "endfor\n"
	         "\n"
	         "h = plot(s);\n"
	         "\n"
	         "if (nargout == 0)\n"
	         "\tclear h;\n"
	         "end\n"
	         "\n"
	         "end\n"
	         "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n"
	         "\n";

	f_out << "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n"
	         "function h = oemsgen_plotVSWR(s, port_n, freq, markers, color, varargin)\n"
	         "%\n"
	         "% input:\n"
	         "%   s:              - S parameter, should be a reflection coefficient (Sxx, no Sxy).\n"
	         "%                   - See example.\n"
	         "%   port_n:         - Port number string.\n"
	         "%   freq:           - Frequency array.\n"
	         "%   markers:        - Frequency array. Put a marker on each frequency inside.\n"
	         "%   color:          - Color letter. See the 'fmt' argument of the Octave 'plot' function.\n"
	         "%\n"
	         "% variable input:\n"
	         "%   'legend_out':   - Put the legend boxe outside the graph.\n"
	         "%                   - Default: false.\n"
	         "%   'funit':        - Frequency unity factor.\n"
	         "%                   - To use with 'funit_name'.\n"
	         "%                   - Default: 1e6\n"
	         "%   'funit_name':   - Frequency unity name.\n"
	         "%                   - To use with 'funit'.\n"
	         "%                   - Default: 'MHz'\n"
	         "%\n"
	         "% example:\n"
	         "%   s11 = port{1}.uf.ref ./ port{1}.uf.inc;\n"
	         "%   figure;\n"
	         "%   oemsgen_plotVSWR(s11, '1', freq, 'g');\n"
	         "%   drawnow;\n"
	         "%\n"
	         "% author: Thomas Lepoix\n"
	         "\n"
	         "\tlegend_out = false;\n"
	         "\tfunit = 1e6;\n"
	         "\tfunit_name = 'MHz';\n"
	         "\n"
	         "\ti = 1;\n"
	         "\twhile i <= numel(varargin)\n"
	         "\t\tif (strcmp(varargin{i}, 'legend_out')==1);\n"
	         "\t\t\tlegend_out = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'funit')==1);\n"
	         "\t\t\tfunit = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'funit_name')==1);\n"
	         "\t\t\tfunit_name = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telse\n"
	         "\t\t\twarning('openEMS:oemsgen_plotVSWR', ['unknown argument key: ''' varargin{i} '''']);\n"
	         "\t\tendif\n"
	         "\t\ti = i + 1;\n"
	         "\tendwhile\n"
	         "\n"
	         "\thold on;\n"
	         "\tgrid on;\n"
	         "\tvswr = (1+(abs(s)))./(1-(abs(s)));\n"
	         "\tplot(freq/funit, vswr, [color, '-'], 'Linewidth', 2);\n"
	         "\tfor i = 1:numel(markers)\n"
	         "\t\tvswr_i = vswr(find(freq == markers(i)));\n"
	         "\t\tplot(freq(find(freq == markers(i)))/funit, vswr_i, ...\n"
	         "\t\t\t[color, 'o;VSWR', port_n, ' @ ', num2str(freq(find(freq == markers(i)))/funit, '%.2f'), ' ', funit_name, ...\n"
	         "\t\t\t\"\\n\", num2str(vswr_i, '%.2f'), ...\n"
	         "\t\t\t';'], 'linewidth', 2);\n"
	         "\tendfor\n"
	         "\tif legend_out\n"
	         "\t\tlegend('Location', 'northeastoutside');\n"
	         "\tendif\n"
	         "\ttitle(['VSWR', port_n]);\n"
	         "\txlabel(['Frequency (', funit_name, ')']);\n"
	         "\tylabel('VSWR');\n"
	         "end\n"
	         "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n"
	         "\n";

	f_out << "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n"
	         "function h = oemsgen_plotFeedImpedance(Z, port_n, freq, markers, abs_color, im_color, re_color, varargin)\n"
	         "%\n"
	         "% input:\n"
	         "%   Z:              - Feed port impedance.\n"
	         "%                   - See example.\n"
	         "%   port_n:         - Port number string.\n"
	         "%   freq:           - Frequency array.\n"
	         "%   markers:        - Frequency array. Put a marker on each frequency inside.\n"
	         "%   abs_color:      - Color letter. See the 'fmt' argument of the Octave 'plot' function.\n"
	         "%                   - Absolute impedance.\n"
	         "%   im_color:       - Color letter. See the 'fmt' argument of the Octave 'plot' function.\n"
	         "%                   - Imaginary part.\n"
	         "%   re_color:       - Color letter. See the 'fmt' argument of the Octave 'plot' function.\n"
	         "%                   - Real part.\n"
	         "%\n"
	         "% variable input:\n"
	         "%   'legend_out':   - Put the legend boxe outside the graph.\n"
	         "%                   - Default: false.\n"
	         "%   'funit':        - Frequency unity factor.\n"
	         "%                   - To use with 'funit_name'.\n"
	         "%                   - Default: 1e6\n"
	         "%   'funit_name':   - Frequency unity name.\n"
	         "%                   - To use with 'funit'.\n"
	         "%                   - Default: 'MHz'\n"
	         "%\n"
	         "% example:\n"
	         "%   z1 = port{1}.uf.tot./port{1}.if.tot;\n"
	         "%   figure;\n"
	         "%   oemsgen_plotFeedImpedance(z1, '1', freq, 'k', 'm', 'g');\n"
	         "%   drawnow;\n"
	         "%\n"
	         "% author: Thomas Lepoix\n"
	         "\n"
	         "\tlegend_out = false;\n"
	         "\tfunit = 1e6;\n"
	         "\tfunit_name = 'MHz';\n"
	         "\n"
	         "\ti = 1;\n"
	         "\twhile i <= numel(varargin)\n"
	         "\t\tif (strcmp(varargin{i}, 'legend_out')==1);\n"
	         "\t\t\tlegend_out = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'funit')==1);\n"
	         "\t\t\tfunit = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'funit_name')==1);\n"
	         "\t\t\tfunit_name = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telse\n"
	         "\t\t\twarning('openEMS:oemsgen_plotFeedImpedance', ['unknown argument key: ''' varargin{i} '''']);\n"
	         "\t\tendif\n"
	         "\t\ti = i + 1;\n"
	         "\tendwhile\n"
	         "\n"
	         "\thold on;\n"
	         "\tgrid on;\n"
	         "\tplot(freq/funit, abs(Z), [abs_color, '-;|Z', port_n, '|;'], 'Linewidth', 2);\n"
	         "\tplot(freq/funit, imag(Z), [im_color, '--;Im(Z', port_n, ');'], 'Linewidth', 2);\n"
	         "\tplot(freq/funit, real(Z), [re_color, '--;Re(Z', port_n, ');'], 'Linewidth', 2);\n"
	         "\tfor i = 1:numel(markers)\n"
	         "\t\tz = Z(find(freq == markers(i)));\n"
	         "\t\tif imag(z) >= 0\n"
	         "\t\t\tz_str = '+';\n"
	         "\t\telse\n"
	         "\t\t\tz_str = '';\n"
	         "\t\tendif\n"
	         "\t\tz_str = [num2str(real(z), '%.2f'), z_str, num2str(imag(z), '%.2f'), 'j'];\n"
	         "\t\tplot(freq(find(freq == markers(i)))/funit, abs(z), ...\n"
	         "\t\t\t[abs_color, 'o;Z', port_n, ' @ ', num2str(freq(find(freq == markers(i)))/funit, '%.2f'), ' ', funit_name, ...\n"
	         "\t\t\t\"\\n\", num2str(abs(z), '%.2f'), ' Ω ', z_str, ...\n"
	         "\t\t\t';'], 'linewidth', 2);\n"
	         "\t\tplot(freq(find(freq == markers(i)))/funit, imag(z), [im_color, 'o'], 'linewidth', 2);\n"
	         "\t\tplot(freq(find(freq == markers(i)))/funit, real(z), [re_color, 'o'], 'linewidth', 2);\n"
	         "\tendfor\n"
	         "\tif legend_out\n"
	         "\t\tlegend('Location', 'northeastoutside');\n"
	         "\tendif\n"
	         "\ttitle(['Impedance Z', port_n]);\n"
	         "\txlabel(['Frequency (', funit_name, ')']);\n"
	         "\tylabel('Impedance (Ω)');\n"
	         "end\n"
	         "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n"
	         "\n";

	f_out << "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n"
	         "function h = oemsgen_plotSParameters(s, names, freq, markers, colors, varargin)\n"
	         "%\n"
	         "% input:\n"
	         "%   s:              - S parameters cell array.\n"
	         "%                   - See example.\n"
	         "%   names:          - S parameters name strings cell array.\n"
	         "%   freq:           - Frequency array.\n"
	         "%   markers:        - Frequency array. Put a marker on each frequency inside.\n"
	         "%   colors:         - Color letters cell array.\n"
	         "%                   - See the 'fmt' argument of the Octave 'plot' function.\n"
	         "%\n"
	         "% variable input:\n"
	         "%   'legend_out':   - Put the legend boxe outside the graph.\n"
	         "%                   - Default: false.\n"
	         "%   'funit':        - Frequency unity factor.\n"
	         "%                   - To use with 'funit_name'.\n"
	         "%                   - Default: 1e6\n"
	         "%   'funit_name':   - Frequency unity name.\n"
	         "%                   - To use with 'funit'.\n"
	         "%                   - Default: 'MHz'\n"
	         "%\n"
	         "% example:\n"
	         "%   figure;\n"
	         "%   oemsgen_plotSParameters({s11, s21}, {'s11', 's21'}, freq, markers, {'m', 'g'});\n"
	         "%   drawnow;\n"
	         "%\n"
	         "% author: Thomas Lepoix\n"
	         "\n"
	         "\tlegend_out = false;\n"
	         "\tfunit = 1e6;\n"
	         "\tfunit_name = 'MHz';\n"
	         "\n"
	         "\ti = 1;\n"
	         "\twhile i <= numel(varargin)\n"
	         "\t\tif (strcmp(varargin{i}, 'legend_out')==1);\n"
	         "\t\t\tlegend_out = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'funit')==1);\n"
	         "\t\t\tfunit = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'funit_name')==1);\n"
	         "\t\t\tfunit_name = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telse\n"
	         "\t\t\twarning('openEMS:oemsgen_plotSParameters', ['unknown argument key: ''' varargin{i} '''']);\n"
	         "\t\tendif\n"
	         "\t\ti = i + 1;\n"
	         "\tendwhile\n"
	         "\n"
	         "\tif numel(s) != numel(names) || numel(s) != numel(colors)\n"
	         "\t\twarning('openEMS:oemsgen_plotSParameters', 'mismatch beteen s, names and colors parameters cell number');\n"
	         "\tendif\n"
	         "\n"
	         "\thold on;\n"
	         "\tgrid on;\n"
	         "\tfor i = 1:numel(s)\n"
	         "\t\tplot(freq/funit, 20*log10(abs(s{i})), [colors{i}, '-'], 'Linewidth', 2);\n"
	         "\t\tfor j = 1:numel(markers)\n"
	         "\t\t\tplot(freq(find(freq == markers(j)))/funit, ...\n"
	         "\t\t\t\t20*log10(abs(s{i}(find(freq == markers(j))))), ...\n"
	         "\t\t\t\t[colors{i}, 'o;', names{i}, ' @ ', num2str(freq(find(freq == markers(j)))/funit, '%.2f'), ' ', funit_name, ...\n"
	         "\t\t\t\t\"\\n\", num2str(20*log10(abs(s{i}(find(freq == markers(j)))))), 'dB', ...\n"
	         "\t\t\t\t';'], 'linewidth', 2);\n"
	         "\t\tendfor\n"
	         "\tendfor\n"
	         "\tif legend_out\n"
	         "\t\tlegend('Location', 'northeastoutside');\n"
	         "\tendif\n"
	         "\ttitle('S parameters');\n"
	         "\txlabel(['Frequency (', funit_name, ')']);\n"
	         "\tylabel('S parameter (dB)');\n"
	         "end\n"
	         "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n"
	         "\n";

	f_out << "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n"
	         "function h = oemsgen_plotSmithChart(s, names, freq, markers, color_order, varargin)\n"
	         "%\n"
	         "% input:\n"
	         "%   s:              - S parameters cell array.\n"
	         "%                   - See example.\n"
	         "%   names:          - S parameters name strings cell array.\n"
	         "%   freq:           - Frequency array.\n"
	         "%   markers:        - Frequency array. Put a marker on each frequency inside.\n"
	         "%   color_order:    - Color order array.\n"
	         "%                   - See the 'ColorOrder' argument of the Octave 'gca' object.\n"
	         "%\n"
	         "% variable input:\n"
	         "%   'legend_out':   - Put the legend boxe outside the graph.\n"
	         "%                   - Default: false.\n"
	         "%   'funit':        - Frequency unity factor.\n"
	         "%                   - To use with 'funit_name'.\n"
	         "%                   - Default: 1e6\n"
	         "%   'funit_name':   - Frequency unity name.\n"
	         "%                   - To use with 'funit'.\n"
	         "%                   - Default: 'MHz'\n"
	         "%\n"
	         "% example:\n"
	         "%   color_order = [ ...\n"
	         "%   \t[1, 0, 1]; ... % m\n"
	         "%   \t[0, 1, 0]];    % g\n"
	         "%   figure;\n"
	         "%   oemsgen_plotSmithChart({s11, s21}, {'s11', 's21'}, freq, markers, color_order);\n"
	         "%   drawnow;\n"
	         "%\n"
	         "% author: Thomas Lepoix\n"
	         "\n"
	         "\tlegend_out = false;\n"
	         "\tfunit = 1e6;\n"
	         "\tfunit_name = 'MHz';\n"
	         "\n"
	         "\ti = 1;\n"
	         "\twhile i <= numel(varargin)\n"
	         "\t\tif (strcmp(varargin{i}, 'legend_out')==1);\n"
	         "\t\t\tlegend_out = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'funit')==1);\n"
	         "\t\t\tfunit = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'funit_name')==1);\n"
	         "\t\t\tfunit_name = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telse\n"
	         "\t\t\twarning('openEMS:oemsgen_plotSmithChart', ['unknown argument key: ''' varargin{i} '''']);\n"
	         "\t\tendif\n"
	         "\t\ti = i + 1;\n"
	         "\tendwhile\n"
	         "\n"
	         "\tif numel(s) != numel(names)\n"
	         "\t\twarning('openEMS:oemsgen_plotSmithChart', 'mismatch beteen s and names parameters cell number');\n"
	         "\tendif\n"
	         "\n"
	         "\tf_index = [];\n"
	         "\tfor i = 1:numel(markers)\n"
	         "\t\tf_index = [f_index, find(freq == markers(i))];\n"
	         "\tendfor\n"
	         "\n"
	         "\tset(gca, 'ColorOrder', color_order, 'NextPlot', 'replacechildren');\n"
	         "\n"
	         "\tfirst = true;\n"
	         "\tfor i = 1:numel(s)\n"
	         "\t\tif first == true\n"
	         "\t\t\tfirst = false;\n"
	         "\t\t\th = plotSmith(s{i}, names{i}, freq, f_index);\n"
	         "\t\telse\n"
	         "\t\t\th = plotSmith(s{i}, names{i}, freq, f_index, 'nogrid');\n"
	         "\t\tendif\n"
	         "\t\tset(h, 'Linewidth', 2);\n"
	         "\tendfor\n"
	         "\tif legend_out\n"
	         "\t\tlegend('Location', 'northeastoutside');\n"
	         "\tendif\n"
	         "end\n"
	         "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n"
	         "\n";

	f_out << "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n"
	         "function oemsgen_postProcess(name, path_simulation, path_result, port, port_index, active_ports, fstart, fstop, points, varargin)\n"
	         "%\n"
	         "% input:\n"
	         "%   name:            - Simulation name.\n"
	         "%   path_simulation: - Simulation directory path.\n"
	         "%   path_result:     - Result directory path.\n"
	         "%   port:            - Ports data structure.\n"
	         "%                    - See 'calcPort' function.\n"
	         "%   port_index:      - Ports numbers.\n"
	         "%                    - Example: [1, 2]\n"
	         "%   active_ports:    - Active ports numbers.\n"
	         "%                    - Example: [1]\n"
	         "%   fstart:          - Start frequency.\n"
	         "%   fstop:           - Stop frequency.\n"
	         "%   points:          - Number of points on graphs.\n"
	         "%\n"
	         "% variable input:\n"
	         "%   'legend_out':         - Put the legend boxe outside the graph.\n"
	         "%                         - Default: false.\n"
	         "%   'graphics_format':    - Format to save graphics.\n"
	         "%                         - See 'print' function.\n"
	         "%                         - Default: '.svg'\n"
	         "%   'nf2ff':              - Enable NF2FF calculation.\n"
	         "%                         - Default: false\n"
	         "%   'nf2ff_data':         - NF2FF data structure.\n"
	         "%                         - See 'CreateNF2FFBox' and 'CalcNF2FF' functions.\n"
	         "%   'nf2ff_mode':         - Set 'CalcNF2FF' 'Mode' argument.\n"
	         "%                         - 0: Read existing datas, calcul NF2FF if no existing datas.\n"
	         "%                         - 1: Calcul NF2FF, overwrite existing datas.\n"
	         "%                         - 2: Do not calcul NF2FF, read existing datas.\n"
	         "%                         - Default: 0\n"
	         "%   'nf2ff_3d':           - Enable 3D far field representation.\n"
	         "%                         - Default: false.\n"
	         "%   'nf2ff_3d_phistep':   - NF2FF 3D Phi angle (elevation) step.\n"
	         "%                         - Default: 5\n"
	         "%   'nf2ff_3d_theta':     - NF2FF 3D Theta angle (azimuth) step.\n"
	         "%                         - Default: 5\n"
	         "%   'nf2ff_3d_frames':    - Create an animated '.gif' of the 3D radiation pattern.\n"
	         "%                         - 1: No '.gif', print a 3D pattern for each marked frequency.\n"
	         "%                         - >1: Number of frames between 'fstart' and 'fstop'.\n"
	         "%                         - Requires ImageMagick.\n"
	         "%                         - See 'plotFF3D_frames' function.\n"
	         "%                         - Default: 1\n"
	         "%   'nf2ff_3d_delay':     - Delay between each '.gif' frame, in ms.\n"
	         "%                         - See 'convert' '-delay' argument.\n"
	         "%                         - Default: 30\n"
	         "%   'nf2ff_3d_dump':      - Dump 3D radiation pattern to visualize with Paraview.\n"
	         "%                         - Default: false\n"
	         "%   'nf2ff_3d_dump_unit': - Dump size unit factor.\n"
	         "%                         - See 'DumpFF2VTK' function.\n"
	         "%                         - Default: 1\n"
	         "%   'f_select':           - Place markers on selected frequencies.\n"
	         "%                         - Without any selected frequency, a marker is placed\n"
	         "%                           at the middle of the frequency range.\n"
	         "%   'f_min':              - Place markers at some curve minimums.\n"
	         "%                         - Example: ['s11', 's21']\n"
	         "%   'f_max':              - Place markers at some curve maximums.\n"
	         "%                         - Example: ['s11', 's21']\n"
	         "%   'f_equal':            - Place markers at some curve nearest points to some value.\n"
	         "%                         - Example: ['s11', 's21'] [-3.5, -20]\n"
	         "%\n"
	         "% author: Thomas Lepoix\n"
	         "\n"
	         "\tlegend_out = false;\n"
	         "\tgraphics_format = '.svg';\n"
	         "\tflag_nf2ff = false;\n"
	         "\tnf2ff_mode = 1;\n"
	         "\tnf2ff_3d = false;\n"
	         "\tnf2ff_3d_phistep = 5;\n"
	         "\tnf2ff_3d_thetastep = 5;\n"
	         "\tnf2ff_3d_frames = 1;\n"
	         "\tnf2ff_3d_delay = 30;\n"
	         "\tnf2ff_3d_dump = false;\n"
	         "\tnf2ff_3d_dump_unit = 1;\n"
	         "\tflag_f = [];\n"
	         "\tf_max = num2str([]);\n"
	         "\tf_min = num2str([]);\n"
	         "\tf_equal_s = num2str([]);\n"
	         "\tf_equal_v = [];\n"
	         "\n"
	         "\ti = 1;\n"
	         "\twhile i <= numel(varargin)\n"
	         "\t\tif (strcmp(varargin{i}, 'legend_out')==1);\n"
	         "\t\t\tlegend_out = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'graphics_format')==1);\n"
	         "\t\t\tgraphics_format = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'nf2ff')==1);\n"
	         "\t\t\tflag_nf2ff = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'nf2ff_data')==1);\n"
	         "\t\t\tnf2ff = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'nf2ff_mode')==1);\n"
	         "\t\t\tnf2ff_mode = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'nf2ff_3d')==1);\n"
	         "\t\t\tnf2ff_3d = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'nf2ff_3d_phistep')==1);\n"
	         "\t\t\tnf2ff_3d_phistep = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'nf2ff_3d_thetastep')==1);\n"
	         "\t\t\tnf2ff_3d_thetastep = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'nf2ff_3d_frames')==1);\n"
	         "\t\t\tnf2ff_3d_frames = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'nf2ff_3d_delay')==1);\n"
	         "\t\t\tnf2ff_3d_delay = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'nf2ff_3d_dump')==1);\n"
	         "\t\t\tnf2ff_3d_dump = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'nf2ff_3d_dump_unit')==1);\n"
	         "\t\t\tnf2ff_3d_dump_unit = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'f_select')==1);\n"
	         "\t\t\tflag_f = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'f_min')==1);\n"
	         "\t\t\tf_min = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'f_max')==1);\n"
	         "\t\t\tf_max = varargin{i+1};\n"
	         "\t\t\ti = i + 1;\n"
	         "\t\telseif (strcmp(varargin{i}, 'f_equal')==1);\n"
	         "\t\t\tf_equal_s = varargin{i+1};\n"
	         "\t\t\tf_equal_v = varargin{i+2};\n"
	         "\t\t\ti = i + 2;\n"
	         "\t\telse\n"
	         "\t\t\ti\n"
	         "\t\t\twarning('openEMS:oemsgen_postProcess', ['unknown argument key: ''' varargin{i} '''']);\n"
	         "\t\tendif\n"
	         "\t\ti = i + 1;\n"
	         "\tendwhile\n"
	         "\n"
	         "%%%% VARIABLES\n"
	         "color_order = [ ...\n"
	         "\t[1, 0, 1]; ... % m\n"
	         "\t[0, 1, 0]; ... % g\n"
	         "\t[0, 1, 1]; ... % c\n"
	         "\t[1, 1, 0]; ... % y\n"
	         "\t[1, 0, 0]; ... % r\n"
	         "\t[0, 0, 1]; ... % b\n"
	         "\t[0, 0, 0]];    % k\n"
	         "color_order_letter = [ ...\n"
	         "\t'm', ...\n"
	         "\t'g', ...\n"
	         "\t'c', ...\n"
	         "\t'y', ...\n"
	         "\t'r', ...\n"
	         "\t'b', ...\n"
	         "\t'k'];\n"
	         "port_suffix = '-p';\n"
	         "frequency_format = ['%0', num2str(numel(num2str(fstop))), '.0f'];\n"
	         "funit = 1e+3;\n"
	         "funit_name = 'kHz';\n"
	         "if fstop >= 1e+9 && fstart >= 1e+9\n"
	         "\tfunit = 1e+9;\n"
	         "\tfunit_name = 'GHz';\n"
	         "elseif fstop >= 1e+6 && fstart >= 1e+6\n"
	         "\tfunit = 1e+6;\n"
	         "\tfunit_name = 'MHz';\n"
	         "endif\n"
	         "freq = linspace(fstart, fstop, points);\n"
	         "if !isempty(flag_f)\n"
	         "\tf_select = flag_f;\n"
	         "\tfreq = [freq, f_select];\n"
	         "\tfreq = sort(unique(freq));\n"
	         "\tpoints = numel(freq);\n"
	         "elseif !isempty(f_max) || !isempty(f_min) || (!isempty(f_equal_s) && !isempty(f_equal_v))\n"
	         "\tf_select = [];\n"
	         "else\n"
	         "\tf_select = [freq(round(points / 2))];\n"
	         "endif\n"
	         "\n"
	         "% calcPort\n"
	         "for i = 1:numel(port_index)\n"
	         "\tport{port_index(i)} = calcPort(port{port_index(i)}, path_simulation, freq);\n"
	         "endfor\n"
	         "\n"
	         "% S parameters\n"
	         "for i = 1:numel(active_ports)\n"
	         "\tport_suffix = [port_suffix, num2str(active_ports(i))];\n"
	         "\tfor j = 1:numel(port_index)\n"
	         "\t\ts{port_index(j), active_ports(i)} = port{port_index(j)}.uf.ref ./ port{active_ports(i)}.uf.inc;\n"
	         "\tendfor\n"
	         "endfor\n"
	         "\n"
	         "if !isempty(f_max)\n"
	         "\tfor i = 1:rows(f_max)\n"
	         "\t\tf_max_str = [f_max(i, 1), '{', f_max(i, 2), ', ', f_max(i, 3), '}'];\n"
	         "\t\tf_select = [f_select, freq(find(eval(f_max_str) == max(eval(f_max_str))))];\n"
	         "\tendfor\n"
	         "endif\n"
	         "if !isempty(f_min)\n"
	         "\tfor i = 1:rows(f_min)\n"
	         "\t\tf_min_str = [f_min(i, 1), '{', f_min(i, 2), ', ', f_min(i, 3), '}'];\n"
	         "\t\tf_select = [f_select, freq(find(eval(f_min_str) == min(eval(f_min_str))))];\n"
	         "\tendfor\n"
	         "endif\n"
	         "if !isempty(f_equal_s) && !isempty(f_equal_v)\n"
	         "\tfor i = 1:rows(f_equal_s)\n"
	         "\t\tf_equal_s_str = [f_equal_s(i, 1), '{', f_equal_s(i, 2), ', ', f_equal_s(i, 3), '}'];\n"
	         "\t\tf_select = [f_select, freq(find( ...\n"
	         "\t\t\tabs(20*log10(abs(eval(f_equal_s_str))) .- f_equal_v(i)) ...\n"
	         "\t\t\t== min(abs(20*log10(abs(eval(f_equal_s_str))) .- f_equal_v(i))) ))];\n"
	         "\tendfor\n"
	         "endif\n"
	         "\n"
	         "%%%% SAVE TOUCHSTONE\n"
	         "spara = [];\n"
	         "for i = 1:numel(port_index)\n"
	         "\tis_active = false;\n"
	         "\tfor j = 1:numel(active_ports)\n"
	         "\t\tif port_index(i) == active_ports(j)\n"
	         "\t\t\tis_active = true;\n"
	         "\t\tendif\n"
	         "\tendfor\n"
	         "\tif is_active\n"
	         "\t\tfor j = 1:numel(port_index)\n"
	         "\t\t\tspara(port_index(j), port_index(i), :) = s{port_index(j), port_index(i)};\n"
	         "\t\tendfor\n"
	         "\telse\n"
	         "\t\tfor j = 1:numel(port_index)\n"
	         "\t\t\tspara(port_index(j), port_index(i), :) = repmat([0], 1, points);\n"
	         "\t\tendfor\n"
	         "\tendif\n"
	         "endfor\n"
	         "write_touchstone('s', freq, spara, [path_result, '/', name, port_suffix, '.s2p']);\n"
	         "% Append header to touchstone file\n"
	         "fd = fopen([path_result, '/', name, port_suffix, '.s2p'], 'r');\n"
	         "tmp = fread(fd);\n"
	         "fclose(fd);\n"
	         "fd = fopen([path_result, '/', name, port_suffix, '.s2p'], 'wt');\n"
	         "header = [\"! Generated by a Qucs-RFlayout generated OpenEMS script\\n\"];\n"
	         "fprintf(fd, '%s%s', header, tmp);\n"
	         "fclose(fd);\n"
	         "\n"
	         "%%%% PLOT S PARAMETERS\n"
	         "spara = {};\n"
	         "names = {};\n"
	         "colors = {};\n"
	         "color_i = 1;\n"
	         "for i = 1:numel(active_ports)\n"
	         "\tfor j = 1:numel(port_index)\n"
	         "\t\tspara = {spara{:}, s{port_index(j), active_ports(i)}};\n"
	         "\t\tnames = {names{:}, ['s', num2str(port_index(j)), num2str(active_ports(i))]};\n"
	         "\t\tcolors = {colors{:}, color_order_letter(color_i)};\n"
	         "\t\tcolor_i = color_i + 1;\n"
	         "\tendfor\n"
	         "endfor\n"
	         "figure;\n"
	         "oemsgen_plotSParameters(spara, names, freq, f_select, colors, ...\n"
	         "\t'legend_out', legend_out, 'funit', funit, 'funit_name', funit_name);\n"
	         "drawnow;\n"
	         "print([path_result, '/', name, '-s', graphics_format]);\n"
	         "\n"
	         "%%%% PLOT SMITH CHART\n"
	         "spara = {};\n"
	         "names = {};\n"
	         "color_order_smith = [];\n"
	         "color_i = 1;\n"
	         "for i = 1:numel(active_ports)\n"
	         "\tfor j = 1:numel(port_index)\n"
	         "\t\tspara = {spara{:}, s{port_index(j), active_ports(i)}};\n"
	         "\t\tnames = {names{:}, ['s', num2str(port_index(j)), num2str(active_ports(i))]};\n"
	         "\t\tcolor_order_smith = [color_order_smith(:,:); [color_order(color_i, :)]];\n"
	         "\t\tcolor_i = color_i + 1;\n"
	         "\tendfor\n"
	         "endfor\n"
	         "figure;\n"
	         "oemsgen_plotSmithChart(spara, names, freq, f_select, color_order_smith, ...\n"
	         "\t'legend_out', legend_out, 'funit', funit, 'funit_name', funit_name);\n"
	         "drawnow;\n"
	         "print([path_result, '/', name, '-smith', graphics_format]);\n"
	         "\n"
	         "%%%% PLOT PORT IMPEDANCES\n"
	         "for i = 1:numel(active_ports)\n"
	         "\tz = port{active_ports(i)}.uf.tot./port{active_ports(i)}.if.tot;\n"
	         "\tfigure;\n"
	         "\toemsgen_plotFeedImpedance(z, num2str(active_ports(i)), freq, f_select, 'k', 'm', 'g', ...\n"
	         "\t\t'legend_out', legend_out, 'funit', funit, 'funit_name', funit_name);\n"
	         "\tdrawnow;\n"
	         "\tprint([path_result, '/', name, '-z', num2str(active_ports(i)), graphics_format]);\n"
	         "endfor\n"
	         "\n"
	         "%%%% PLOT PORT VSWR\n"
	         "for i = 1:numel(active_ports)\n"
	         "\tfigure;\n"
	         "\toemsgen_plotVSWR(s{active_ports(i), active_ports(i)}, num2str(active_ports(i)), freq, f_select, color_order_letter(i), ...\n"
	         "\t\t'legend_out', legend_out, 'funit', funit, 'funit_name', funit_name);\n"
	         "\tdrawnow;\n"
	         "\tprint([path_result, '/', name, '-vswr', num2str(active_ports(i)), graphics_format]);\n"
	         "endfor\n"
	         "\n"
	         "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% NF2FF\n"
	         "\n"
	         "if flag_nf2ff\n"
	         "\n"
	         "%%%% ELEVATION\n"
	         "% A trick to use only needed colors as 'polarFF()' interfer with color order\n"
	         "color_order_polar = [ ...\n"
	         "\tcolor_order(1, :); ...\n"
	         "\tcolor_order(2, :)];\n"
	         "nf2ff_elev = CalcNF2FF(nf2ff, path_simulation, f_select, ...\n"
	         "\t[-180:2:180]*pi/180, [0, 90]*pi/180, ...\n"
	         "\t'Center', nf2ff.center, ...\n"
	         "\t'Verbose', 1, 'Mode', nf2ff_mode, 'Outfile', 'nf2ff_theta.h5');\n"
	         "\n"
	         "% Polar dB normalized\n"
	         "for i = 1:numel(f_select)\n"
	         "\tfigure;\n"
	         "\tset(gca, 'ColorOrder', color_order_polar, 'NextPlot', 'replacechildren');\n"
	         "\th = polarFF(nf2ff_elev, 'freq_index', i, 'xaxis', 'theta', 'param', [1, 2], 'normalize', 1, 'xtics', 10);\n"
	         "\tset(h, 'Linewidth', 2);\n"
	         "\tdrawnow;\n"
	         "\tprint([path_result, '/', name, '-ff-elev-polar-dbn@', ...\n"
	         "\t\tnum2str(f_select(i), frequency_format), ...\n"
	         "\t\tgraphics_format]);\n"
	         "endfor\n"
	         "\n"
	         "% Polar dBi\n"
	         "for i = 1:numel(f_select)\n"
	         "\tfigure;\n"
	         "\tset(gca, 'ColorOrder', color_order_polar, 'NextPlot', 'replacechildren');\n"
	         "\th = polarFF(nf2ff_elev, 'freq_index', i, 'xaxis', 'theta', 'param', [1, 2], 'logscale', [-20, 10], 'xtics', 10);\n"
	         "\tset(h, 'Linewidth', 2);\n"
	         "\tdrawnow;\n"
	         "\tprint([path_result, '/', name, '-ff-elev-polar-dbi@', ...\n"
	         "\t\tnum2str(f_select(i), frequency_format), ...\n"
	         "\t\tgraphics_format]);\n"
	         "endfor\n"
	         "\n"
	         "% Rect dBi\n"
	         "for i = 1:numel(f_select)\n"
	         "\tfigure;\n"
	         "\tset(gca, 'ColorOrder', color_order, 'NextPlot', 'replacechildren');\n"
	         "\th = plotFFdB(nf2ff_elev, 'freq_index', i, 'xaxis', 'theta', 'param', [1, 2]);\n"
	         "\tset(h, 'Linewidth', 2);\n"
	         "\tif legend_out\n"
	         "\t\tlegend('Location', 'northeastoutside');\n"
	         "\tendif\n"
	         "\tdrawnow;\n"
	         "\tprint([path_result, '/', name, '-ff-elev-rect-dbi@', ...\n"
	         "\t\tnum2str(f_select(i), frequency_format), ...\n"
	         "\t\tgraphics_format]);\n"
	         "endfor\n"
	         "\n"
	         "%%%% AZIMUTH\n"
	         "% A trick to use only needed colors as 'polarFF()' interfer with color order\n"
	         "color_order_polar = [ ...\n"
	         "\tcolor_order(3, :); ...\n"
	         "\tcolor_order(1, :); ...\n"
	         "\tcolor_order(2, :)];\n"
	         "nf2ff_azim = CalcNF2FF(nf2ff, path_simulation, f_select, ...\n"
	         "\t[30, 60, 90]*pi/180, [-180:2:180]*pi/180, ...\n"
	         "\t'Center', nf2ff.center, ...\n"
	         "\t'Verbose', 1, 'Mode', nf2ff_mode, 'Outfile', 'nf2ff_phi.h5');\n"
	         "\n"
	         "% Polar dB normalized\n"
	         "for i = 1:numel(f_select)\n"
	         "\tfigure;\n"
	         "\tset(gca, 'ColorOrder', color_order_polar, 'NextPlot', 'replacechildren');\n"
	         "\th = polarFF(nf2ff_azim, 'freq_index', i, 'xaxis', 'phi', 'param', [1, 2, 3], 'normalize', 1, 'xtics', 10);\n"
	         "\tset(h, 'Linewidth', 2);\n"
	         "\tdrawnow;\n"
	         "\tprint([path_result, '/', name, '-ff-azim-polar-dbn@', ...\n"
	         "\t\tnum2str(f_select(i), frequency_format), ...\n"
	         "\t\tgraphics_format]);\n"
	         "endfor\n"
	         "\n"
	         "% Polar dBi\n"
	         "for i = 1:numel(f_select)\n"
	         "\tfigure;\n"
	         "\tset(gca, 'ColorOrder', color_order_polar, 'NextPlot', 'replacechildren');\n"
	         "\th = polarFF(nf2ff_azim, 'freq_index', i, 'xaxis', 'phi', 'param', [1, 2, 3], 'logscale', [-20, 10], 'xtics', 10);\n"
	         "\tset(h, 'Linewidth', 2);\n"
	         "\tdrawnow;\n"
	         "\tprint([path_result, '/', name, '-ff-azim-polar-dbi@', ...\n"
	         "\t\tnum2str(f_select(i), frequency_format), ...\n"
	         "\t\tgraphics_format]);\n"
	         "endfor\n"
	         "\n"
	         "% Rect dBi\n"
	         "for i = 1:numel(f_select)\n"
	         "\tfigure;\n"
	         "\tset(gca, 'ColorOrder', color_order, 'NextPlot', 'replacechildren');\n"
	         "\th = plotFFdB(nf2ff_azim, 'freq_index', i, 'xaxis', 'phi', 'param', [1, 2, 3]);\n"
	         "\tset(h, 'Linewidth', 2);\n"
	         "\tif legend_out\n"
	         "\t\tlegend('Location', 'northeastoutside');\n"
	         "\tendif\n"
	         "\tdrawnow;\n"
	         "\tprint([path_result, '/', name, '-ff-azim-rect-dbi@', ...\n"
	         "\t\tnum2str(f_select(i), frequency_format), ...\n"
	         "\t\tgraphics_format]);\n"
	         "endfor\n"
	         "\n"
	         "%%%% 3D\n"
	         "if nf2ff_3d\n"
	         "phi_range = [-180:nf2ff_3d_phistep:180];\n"
	         "theta_range = [0:nf2ff_3d_thetastep:180];\n"
	         "if nf2ff_3d_frames > 1\n"
	         "\tfreqs = [fstart:(fstop-fstart) / (nf2ff_3d_frames-1):fstop];\n"
	         "\tgif = true;\n"
	         "\tshow_each = false;\n"
	         "else\n"
	         "\tfreqs = f_select;\n"
	         "\tgif = false;\n"
	         "\tshow_each = true;\n"
	         "endif\n"
	         "nf2ff_3d = CalcNF2FF(nf2ff, path_simulation, freqs, theta_range*pi/180, phi_range*pi/180, ...\n"
	         "\t'Center', nf2ff.center, ...\n"
	         "\t'Verbose', 1, 'Mode', nf2ff_mode, 'Outfile', 'nf2ff_3d.h5');\n"
	         "\n"
	         "% V/m\n"
	         "plotFF3D_frames(nf2ff_3d, [path_result, '/', name, '-ff-3d-vm'], ...\n"
	         "\t'gif', gif, 'show_each', show_each, 'delay', nf2ff_3d_delay, ...\n"
	         "\t'unique_color_scale', 'unique_axis_scale');\n"
	         "\n"
	         "% Dump\n"
	         "if nf2ff_3d_dump\n"
	         "\tE_far_normalized = nf2ff_3d.E_norm{1} / max(nf2ff_3d.E_norm{1}(:)) * nf2ff_3d.Dmax(1);\n"
	         "\tDumpFF2VTK([path_simulation '/ff.vtk'], E_far_normalized, theta_range, phi_range, 'scale', nf2ff_3d_dump_unit * 10);\n"
	         "endif\n"
	         "\n"
	         "endif % nf2ff_3d\n"
	         "endif % flag_nf2ff\n"
	         "\n"
	         "end\n"
	         "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n"
	         "\n";

	f_out << "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% POSTPROCESSING\n"
	         "\n";

	f_out << "% NF2FF center should be placed at the center of the radiating element.\n" <<
	         (data.oems_nf2ff_center!=""
	         ? "%nf2ff.center = [(max(mesh.x)-min(mesh.x))/2, (max(mesh.y)-min(mesh.y))/2, 0];\n"
	           "nf2ff.center = " + data.oems_nf2ff_center + ".center;\n"
	         : "nf2ff.center = [(max(mesh.x)-min(mesh.x))/2, (max(mesh.y)-min(mesh.y))/2, 0];\n"
			 ) <<
	         "\n"
	         "t_postprocess_start = clock();\n"
	         "oemsgen_postProcess('lpf', path_simulation, path_result, port, [1, 2], [1], fstart, fstop, points, ...\n"
	         "\t'legend_out', flag_legend_out, ...\n"
	         "\t'nf2ff', flag_nf2ff, ...\n"
	         "\t'nf2ff_data', nf2ff, ...\n"
	         "\t'nf2ff_mode', flag_nf2ff_mode, ...\n"
	         "\t'nf2ff_3d', flag_nf2ff_3d, ...\n"
	         "\t'nf2ff_3d_phistep', flag_nf2ff_phistep, ...\n"
	         "\t'nf2ff_3d_thetastep', flag_nf2ff_thetastep, ...\n"
	         "\t'nf2ff_3d_frames', flag_nf2ff_frames, ...\n"
	         "\t'nf2ff_3d_delay', flag_nf2ff_delay, ...\n"
	         "\t'nf2ff_3d_dump', flag_dump, ...\n"
	         "\t'nf2ff_3d_dump_unit', unit, ...\n"
	         "\t'f_select', flag_f, ...\n"
	         "\t'f_min', flag_f_min, ...\n"
	         "\t'f_max', flag_f_max, ...\n"
	         "\t'f_equal', flag_f_equal_s, flag_f_equal_v);\n"
	         "t_postprocess_stop = clock();\n"
	         "\n";

	f_out << "%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% SYSTEM\n"
	         "\n";

	f_out << "%%%% TIMES\n"
	         "disp(\"\\nDurations :\");\n"
	         "d_total = 0;\n"
	         "if flag_preprocess\n"
	         "\td_preprocess = etime(t_preprocess_stop, t_preprocess_start);\n"
	         "\th_preprocess = fix(d_preprocess / 3600);\n"
	         "\tm_preprocess = fix((d_preprocess - h_preprocess*3600) / 60);\n"
	         "\ts_preprocess = round(d_preprocess - h_preprocess*3600 - m_preprocess*60);\n"
	         "\tdisp(['Preprocessing : ', ...\n"
	         "\t\tnum2str(h_preprocess), 'h ', ...\n"
	         "\t\tnum2str(m_preprocess), 'm ', ...\n"
	         "\t\tnum2str(s_preprocess), 's']);\n"
	         "\td_total = d_total + d_preprocess;\n"
	         "endif\n"
	         "if flag_process\n"
	         "\td_process = etime(t_process_stop, t_process_start);\n"
	         "\th_process = fix(d_process / 3600);\n"
	         "\tm_process = fix((d_process - h_process*3600) / 60);\n"
	         "\ts_process = round(d_process - h_process*3600 - m_process*60);\n"
	         "\tdisp(['Processing : ', ...\n"
	         "\t\tnum2str(h_process), 'h ', ...\n"
	         "\t\tnum2str(m_process), 'm ', ...\n"
	         "\t\tnum2str(s_process), 's']);\n"
	         "\td_total = d_total + d_process;\n"
	         "endif\n"
	         "if flag_postprocess\n"
	         "\td_postprocess = etime(t_postprocess_stop, t_postprocess_start);\n"
	         "\th_postprocess = fix(d_postprocess / 3600);\n"
	         "\tm_postprocess = fix((d_postprocess - h_postprocess*3600) / 60);\n"
	         "\ts_postprocess = round(d_postprocess - h_postprocess*3600 - m_postprocess*60);\n"
	         "\tdisp(['Postprocessing : ', ...\n"
	         "\t\tnum2str(h_postprocess), 'h ', ...\n"
	         "\t\tnum2str(m_postprocess), 'm ', ...\n"
	         "\t\tnum2str(s_postprocess), 's']);\n"
	         "\td_total = d_total + d_postprocess;\n"
	         "endif\n"
	         "h_total = fix(d_total / 3600);\n"
	         "m_total = fix((d_total - h_total*3600) / 60);\n"
	         "s_total = round(d_total - h_total*3600 - m_total*60);\n"
	         "disp(['Total : ', ...\n"
	         "\tnum2str(h_total), 'h ', ...\n"
	         "\tnum2str(m_total), 'm ', ...\n"
	         "\tnum2str(s_total), 's']);\n"
	         "\n";

	f_out << "if flag_postprocess\n"
	         "disp(\"\\nTerminated, press any key to exit.\");\n"
	         "pause();\n"
	         "endif % flag_postprocess\n"
	         "return;\n";
	}
